{"version":3,"sources":["assets/plugin-function.svg","assets/close.svg","ExcelEditor/Constants.ts","ExcelEditor/Component/PlaceHolder.tsx","ExcelEditor/Component/GridHorizontalLine.tsx","ExcelEditor/Component/GridVirtualLine.tsx","ExcelEditor/Component/Toolbar.tsx","ExcelEditor/Component/Modal.tsx","common/utils.ts","ExcelEditor/Plugin/Function.tsx","ExcelEditor/Plugin/index.ts","ExcelEditor/Plugin/ColSort.tsx","ExcelEditor/Plugin/RowSort.tsx","ExcelEditor/Store/index.tsx","ExcelEditor/Component/GridValues.tsx","ExcelEditor/Component/VirtualPagerCell.tsx","ExcelEditor/Component/VirtualPagerRow.tsx","ExcelEditor/Component/HeaderCell.tsx","ExcelEditor/Component/HeaderHorizontal.tsx","ExcelEditor/Component/HeaderVertical.tsx","ExcelEditor/Component/Selection.tsx","ExcelEditor/Effects/virtualScrollEffect.ts","ExcelEditor/Effects/selectionEffect.ts","ExcelEditor/Common.ts","ExcelEditor/Effects/modeChangeEffect.ts","ExcelEditor/Effects/resizeEffect.ts","ExcelEditor/Editor.tsx","ExcelEditor/index.tsx","themes/GlobalStyles.ts","App.tsx","serviceWorker.ts","index.tsx","assets/plugin-sort-asc.svg","assets/plugin-sort-desc.svg"],"names":["module","exports","__webpack_require__","p","DirectionType","PlaceHolder","_ref","type","size","rest","Object","objectWithoutProperties","react_default","a","createElement","StyledPlaceHolder","assign","style","width","Virtual","height","styled","div","withConfig","displayName","componentId","GridHorizontalLine","rows","sheetRowIndex","sheetCellIndex","GridHorizontalLineContainer","Array","fill","map","value","index","HorizontalLineItem","key","concat","props","GridVirtualLine","cells","GridVirtualLineContainer","VirtualLineItem","Toolbar","isInputMode","selection","_useStore","useStore","_useStore2","slicedToArray","plugins","settings","dispatch","action","useCallback","pluginType","pluginAction","e","ActionType","PluginAction","payload","ToolbarContainer","Component","Plugins","Fragment","ToolbarSplitLine","ToolBarHeight","ToolbarCellContainerHeader","ToolbarCell","attrs","_ref2","disable","className","cls","ToolbarCellContainer","IconsContainer","_ref3","_ref3$size","css","IconsImage","img","_ref4","src","Portal","children","mountNode","document","useEffect","body","appendChild","removeChild","ReactDom","createPortal","Modal","React","memo","_ref2$width","_ref2$height","title","_ref2$onClose","onClose","_ref2$onSure","onSure","onCloseHanlder","onSureHanlder","Modal_Portal","ModalBackGround","ModalPosition","ModalBox","ModalHeader","ModalTitle","CloseButton","onClick","ModalBody","ModalFooter","ModalSureButton","ModalCloseButton","close","button","defaultScrollWidth","scrollbarWidth","odiv","overflowY","offsetWidth","clientWidth","remove","_forEach","forEach","trim","string","replace","el","_len","arguments","length","args","_key","apply","hasClass","indexOf","Error","classList","contains","addClass","curClass","classes","split","i","j","clsName","add","removeClass","ACode","charCodeAt","toIndex","columnName","charsLenght","Math","pow","toName","String","fromCharCode","PLUGIN_TYPE","initialValues","begin","end","emptySelection","state","functionstate","openDialog","actions","FUNCTION_DEFAULT_ACTION","FUNCTION_CLOSE_MODAL_ACTION","FUNCTION_SAVE_ACTION","regForCellName","convertData","functionDataValue","params","area","point","matches","match","original","schema","Yup","shape","required","ModalContent","ErrorContainer","span","Function","isDisable","getDisable","formRef","useRef","dispath","FUNCTION","current","submitForm","onSumbit","values","pluginFunction","Component_Modal","formik_esm","ref","onSubmit","validationSchema","handleSubmit","component","name","placeholder","reducer","cellInitialValues","objectSpread","disablekeyboardMonitoring","startRowIndex","startCellIndex","extendData","defineProperty","DataType","data","COL_SORT_DEFAULT_ACTION","COL_SORT_DEFAULT_ACTION_DESC","ColSort","COL_SORT","pluginSortAsc","pluginSortDesc","_ref$payload","_ref$payload$selectio","endRowIndex","endCellIndex","d","arr","colStart","colEnd","rowStart","rowEnd","col","colarr","row","push","_","sortBy","reverse","ROW_SORT_DEFAULT_ACTION","ROW_SORT_DEFAULT_ACTION_DESC","RowSort","ROW_SORT","rowarr","Plugin","_PLUGIN_TYPE$FUNCTION","PluginFunction","PluginColSort","PluginRowSort","pluginState","keys","initialState","newData","Update","Delete","DataContext","createContext","DataProvider","contextValue","useReducer","Provider","useContext","GridValues","pageRowIndex","pageCellIndex","storeData","getFunctionValue","total","areaIndex","_params$areaIndex","start","_start","scindex","srindex","_end","ecindex","erindex","rowindex","cellindex","cellData","Number","_unused","GridValuesContainer","rowIndex","rowNumber","GridRow","cellIndex","cellNumber","GridCell","id","left","CellWidth","VirtualPagerCell","pageVerticalIndex","pageHorizontalIndex","StyledVirtualPagerCell","Component_GridHorizontalLine","Component_GridVirtualLine","Component_GridValues","CellHeight","VirtualPagerRow","perLoadHorizontalCount","rearLoadHorizontalCount","StyledVirtualPagerRow","Component_PlaceHolder","Horizontal","count","Component_VirtualPagerCell","HeaderCell","StyledHeaderCell","HeaderHorizontal","headerRef","HeaderHorizontalContainer","HeaderCorner","HeaderContainer","HeaderHorizontal_StyledPlaceHolder","CellsContainer","pageIndex","HeaderPager","data-key","keyIndex","Component_HeaderCell","HeaderVertical","perLoadVerticalCount","rearLoadVerticalCount","HeaderVerticalContainer","HeaderVertical_HeaderContainer","HeaderVertical_HeaderPager","Selection","selectionRef","exitInputMode","_useStore2$0$data$","_useStore2$0$data$$va","inputValue","handleBlur","input","focus","select","SelectionContainer","SelectionBorder","SelectionInnerBorder","SelectionInputArea","StyledInput","defaultValue","onBlur","SelectionAreaTop","SelectionAreaBottom","commonStyle","useVirtualScrollEffect","verticalHeaderRef","horizontalHeaderRef","verticalScrollCache","horizontalScrollCache","updatePageHorizontalDataHander","updatePageVerticalDataHander","vel","hel","scrollTop","scrollLeft","handler","container","currentPageHorizontalIndex","currentPageVerticalIndex","target","floor","addEventListener","removeEventListener","useSelectionEffect","setSelection","deleteSelection","sRowIndex","sCellIndex","eRowIndex","eCellIndex","isHReverse","isVReverse","cacheOnselectstart","selectionEl","checkInputMode","querySelector","realTimeRender","_calcStyle","display","top","abs","calcStyle","querySelectorAll","corner","reduce","c","mouseDownHandler","onselectstart","clientX","clientY","mouseUpHandler","mouseMoveHandler","keyCode","includes","nodeName","useModeChangeEffect","enableInputMode","dblClickHandler","useResizeEffect","updateLoadHorizontalCount","updateLoadVerticalCount","throttle","offsetHeight","ceil","window","TableContainer","VirtualContainer","ContentContainer","Editor","_useState","useState","_useState2","_useState3","_useState4","setInputMode","_useState5","_useState6","setVerticalScrollCache","_useState7","_useState8","updatePageVerticalIndex","_useState9","_useState10","coefficientVertical","updateCoefficientVertical","_useState11","_useState12","updatePerLoadVerticalCount","_useState13","_useState14","updateRearLoadVerticalCount","cacheX","cacheY","unstable_batchedUpdates","setHorizontalScrollCache","n","_useState15","_useState16","_useState17","_useState18","updatePageHorizontalIndex","_useState19","_useState20","coefficientHorizontal","updateCoefficientHorizontal","_useState21","_useState22","updatePerLoadHorizontalCount","_useState23","_useState24","updateRearLoadHorizontalCount","VirtualPagerRowProps","_selection","VerticalHeaderProps","selectionStart","selectionEnd","HorizontalHeaderProps","isNumber","isNaN","cell","Component_Toolbar","Component_HeaderHorizontal","Component_HeaderVertical","Component_VirtualPagerRow","Component_Selection","ExcelEditor","Store_DataProvider","ExcelEditor_Editor","GlobalStyle","createGlobalStyle","_templateObject","AppContainer","App","src_ExcelEditor","Boolean","location","hostname","ReactDOM","render","src_App","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.ddc9dac9.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/plugin-function.a701f2ea.svg\";","module.exports = __webpack_public_path__ + \"static/media/close.1257f21e.svg\";","export const ToolBarHeight: number = 100;\nexport const ToolBarCellWidth: number = 100;\nexport const HeaderVerticalSize: number = 40;\nexport const HeaderHorizontalSize: number = 20;\nexport const CellWidth: number = 80;\nexport const CellHeight: number = 20;\nexport const SheetRowsCount: number = 50;\nexport const SheetCellsCount: number = 20;\nexport const PageHorizontalSize: number = CellWidth * SheetCellsCount;\nexport const PageVerticalSize: number = CellHeight * SheetRowsCount;\nexport const PerLoadCountDefault: number = 1;\nexport const RearLoadCountDefault: number = 2;\nexport const Colors: string[] = [\"green\", \"blue\", \"red\", \"yellow\"];\nexport enum DirectionType {\n  Virtual,\n  Horizontal\n}\n","import React, { FunctionComponent } from \"react\";\nimport styled from \"styled-components\";\nimport { DirectionType } from \"../Constants\";\n\ninterface IPlaceHolder {\n  size: number;\n  type: DirectionType;\n}\n\nconst PlaceHolder: FunctionComponent<IPlaceHolder> = ({\n  type,\n  size,\n  ...rest\n}) => {\n  return (\n    <StyledPlaceHolder\n      {...rest}\n      style={{\n        width: type === DirectionType.Virtual ? 1 : size,\n        height: type === DirectionType.Virtual ? size : 1\n      }}\n    />\n  );\n};\n\nexport default PlaceHolder;\n\nconst StyledPlaceHolder: any = styled.div<IPlaceHolder>``;\n","import React, { FunctionComponent } from \"react\";\nimport styled from \"styled-components\";\ninterface IGridHorizontalLineProps {\n  sheetRowIndex: number;\n  sheetCellIndex: number;\n  rows: number;\n  size: number;\n}\nconst GridHorizontalLine: FunctionComponent<IGridHorizontalLineProps> = ({\n  rows,\n  size,\n  sheetRowIndex,\n  sheetCellIndex\n}) => {\n  return (\n    <GridHorizontalLineContainer>\n      {new Array(rows).fill(null).map((value, index) => (\n        <HorizontalLineItem\n          size={size}\n          key={`horizontal-line-${sheetRowIndex}-${sheetCellIndex}-${index}`}\n        />\n      ))}\n    </GridHorizontalLineContainer>\n  );\n};\n\nexport default GridHorizontalLine;\n\nconst GridHorizontalLineContainer: any = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  flex-direction: column;\n`;\nconst HorizontalLineItem: any = styled.div`\n  width: 100%;\n  height: ${(props: { size: number }) => props.size}px;\n  border-bottom: 1px solid #d4d4d4;\n`;\n","import React, { FunctionComponent } from \"react\";\nimport styled from \"styled-components\";\ninterface IGridVirtualLineProps {\n  sheetRowIndex: number;\n  sheetCellIndex: number;\n  cells: number;\n  size: number;\n}\nconst GridVirtualLine: FunctionComponent<IGridVirtualLineProps> = ({\n  cells,\n  size,\n  sheetRowIndex,\n  sheetCellIndex\n}) => {\n  return (\n    <GridVirtualLineContainer>\n      {new Array(cells).fill(null).map((value, index) => (\n        <VirtualLineItem\n          size={size}\n          key={`virtual-line-${sheetRowIndex}-${sheetCellIndex}-${index}`}\n        />\n      ))}\n    </GridVirtualLineContainer>\n  );\n};\n\nexport default GridVirtualLine;\n\nconst GridVirtualLineContainer: any = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  flex-direction: row;\n`;\nconst VirtualLineItem: any = styled.div`\n  height: 100%;\n  width: ${(props: { size: number }) => props.size}px;\n  border-right: 1px solid #d4d4d4;\n`;\n","import React, { FunctionComponent, useCallback } from \"react\";\nimport styled, { css } from \"styled-components\";\nimport cls from \"classnames\";\nimport { ToolBarCellWidth, ToolBarHeight } from \"../Constants\";\nimport Plugins, { PLUGIN_TYPE, PLUGIN_ACTION } from \"../Plugin\";\nimport useStore, { ActionType } from \"../Store\";\n\nexport interface IToolbarProps {\n  isInputMode: boolean;\n  selection?: [number, number, number, number];\n}\n\nexport interface IPluginProps extends IToolbarProps {\n  action: (\n    pluginType: PLUGIN_TYPE,\n    pluginAction: PLUGIN_ACTION\n  ) => (e: MouseEvent) => void;\n}\n\nconst Toolbar: FunctionComponent<IToolbarProps> = ({\n  isInputMode,\n  selection\n}) => {\n  const [\n    {\n      settings: { plugins }\n    },\n    dispatch\n  ] = useStore();\n\n  const action = useCallback(\n    (pluginType, pluginAction) => (e: MouseEvent) => {\n      dispatch({\n        type: ActionType.PluginAction,\n        payload: {\n          pluginType,\n          pluginAction,\n          selection\n        }\n      });\n    },\n    [dispatch, selection]\n  );\n\n  return (\n    <ToolbarContainer>\n      {plugins.map(type => {\n        const { Component } = Plugins[type as PLUGIN_TYPE];\n        return (\n          <React.Fragment key={`fragment-${type}`}>\n            <ToolbarSplitLine key={`line-${type}`} />\n            <Component\n              action={action}\n              isInputMode={isInputMode}\n              selection={selection}\n              key={`button-${type}`}\n            />\n          </React.Fragment>\n        );\n      })}\n      <ToolbarSplitLine key={`last-line`} />\n    </ToolbarContainer>\n  );\n};\n\nexport default Toolbar;\n\nconst ToolbarContainer: any = styled.div`\n  height: ${ToolBarHeight}px;\n  display: grid;\n  grid-template-columns: repeat(auto-fill, 1px ${ToolBarCellWidth}px);\n  grid-column-gap: 2px;\n  padding: 2px;\n  box-sizing: border-box;\n  border-bottom: 1px solid #ccc;\n`;\n\nconst ToolbarSplitLine: any = styled.div`\n  background: white;\n  height: ${ToolBarHeight - 4}px;\n  background: #ccc;\n`;\n\nexport const ToolbarCellContainerHeader: any = styled.div`\n  height: 20px;\n  text-align: center;\n  border-bottom: 1px solid #ccc;\n`;\n\nexport const ToolbarCell: any = styled.div.attrs(\n  ({ disable }: { disable: boolean }) => ({\n    className: cls(disable ? \"disable\" : \"\")\n  })\n)`\n  cursor: pointer;\n  text-align: center;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-direction: column;\n  box-sizing: border-box;\n  border: 1px solid transparent;\n  &:hover {\n    background: #efefef;\n    border: 1px solid #ccc;\n  }\n\n  &.disable {\n    opacity: 0.5;\n    cursor: not-allowed;\n    &:hover {\n      background: white;\n      border: 1px solid transparent;\n    }\n  }\n`;\n\nexport const ToolbarCellContainer: any = styled.div`\n  display: grid;\n  grid-template-rows: 20px auto;\n  grid-row-gap: 2px;\n  ${ToolbarCell} {\n    height: auto;\n    flex-direction: row;\n  }\n`;\n\nexport const IconsContainer: any = styled.div<{ size: number[] }>`\n  overflow: hidden;\n  position: relative;\n  margin: 5px;\n  ${({ size: [width, height] }) => css`\n    width: ${width}px;\n    height: ${height}px;\n  `}\n`;\nexport const IconsImage: any = styled.img.attrs(({ src }) => ({\n  src: src\n}))`\n  position: absolute;\n  width: 100%;\n  top: 0px;\n  left: 0px;\n`;\n","import React, { FunctionComponent, useEffect, useCallback } from \"react\";\nimport ReactDom from \"react-dom\";\nimport styled, { css } from \"styled-components\";\nimport close from \"../../assets/close.svg\";\n\ninterface IModalProps {\n  width?: number;\n  height?: number;\n  title: string;\n}\n\ninterface IModalActions {\n  onClose?: () => void;\n  onSure?: () => void;\n}\n\nconst Portal: React.FC = ({ children }) => {\n  const mountNode = document.createElement(\"div\");\n  useEffect(() => {\n    document.body.appendChild(mountNode);\n    return () => {\n      document.body.removeChild(mountNode);\n    };\n  });\n\n  return ReactDom.createPortal(children, mountNode);\n};\n\nconst Modal: FunctionComponent<\n  React.PropsWithChildren<\n    React.ReactElement | React.ReactNode | HTMLElement | Element\n  > &\n    IModalProps &\n    IModalActions\n> = React.memo(\n  ({\n    children,\n    width = 800,\n    height = 600,\n    title,\n    onClose = () => {},\n    onSure = () => {}\n  }) => {\n    const onCloseHanlder = useCallback(() => {\n      onClose && onClose();\n    }, [onClose]);\n    const onSureHanlder = useCallback(() => {\n      onSure && onSure();\n    }, [onSure]);\n    return (\n      <Portal>\n        <ModalBackGround>\n          <ModalPosition>\n            <ModalBox width={width} height={height}>\n              <ModalHeader>\n                <ModalTitle>{title}</ModalTitle>\n                <CloseButton onClick={onCloseHanlder} />\n              </ModalHeader>\n              <ModalBody>{children}</ModalBody>\n              <ModalFooter>\n                <ModalSureButton onClick={onSureHanlder}></ModalSureButton>\n                <ModalCloseButton onClick={onCloseHanlder}>\n                  \n                </ModalCloseButton>\n              </ModalFooter>\n            </ModalBox>\n          </ModalPosition>\n        </ModalBackGround>\n      </Portal>\n    );\n  }\n);\n\nexport default Modal;\n\nconst ModalBackGround: any = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  height: 100vh;\n  width: 100vw;\n  background: rgba(0, 0, 0, 0.2);\n  z-index: 9999;\n`;\n\nconst ModalPosition: any = styled.div`\n  height: 80vh;\n  width: 100vw;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n`;\n\nconst ModalBox: any = styled.div<IModalProps>`\n  ${({ width, height }) => css`\n    width: ${width}px;\n    height: ${height}px;\n  `}\n  background: white;\n  border: 1px solid #217346;\n  display: flex;\n  flex-direction: column;\n  box-shadow: 0 0 2px #217346;\n`;\nconst CloseButton: any = styled.img.attrs({\n  src: close\n})`\n  height: 16px;\n  width: 16px;\n  cursor: pointer;\n`;\nconst ModalTitle: any = styled.div`\n  flex: 1;\n  color: white;\n`;\nconst ModalHeader: any = styled.div`\n  height: 30px;\n  padding: 7px;\n  box-sizing: border-box;\n  border-bottom: 1px solid #217346;\n  background: #217346;\n  display: flex;\n`;\n\nconst ModalFooter: any = styled.div`\n  height: 40px;\n  background: #c7d6ce;\n  text-align: right;\n  padding: 10px;\n  box-sizing: border-box;\n  button {\n    margin-left: 10px;\n  }\n`;\n\nconst ModalBody: any = styled.div`\n  flex: 1;\n  overflow: auto;\n`;\n\nconst ModalCloseButton: any = styled.button`\n  height: 20px;\n`;\nconst ModalSureButton: any = styled.button`\n  height: 20px;\n`;\n","export const defaultScrollWidth = (function() {\n  let odiv: HTMLDivElement = document.createElement(\"div\");\n  let scrollbarWidth: number;\n\n  odiv.style.width = \"100px\";\n  odiv.style.height = \"100px\";\n  odiv.style.overflowY = \"scroll\";\n  document.body.appendChild(odiv);\n  scrollbarWidth = odiv.offsetWidth - odiv.clientWidth;\n  odiv.remove();\n  return scrollbarWidth;\n})();\n\nconst originArray: [] = [];\nconst _forEach = originArray.forEach;\n\nexport const trim = function(string: string) {\n  return (string || '').replace(/^[\\s\\uFEFF]+|[\\s\\uFEFF]+$/g, '');\n};\n\nexport function forEach(el: NodeListOf<HTMLElement>, ...args: any) {\n  return _forEach.apply(el, args);\n}\n\nexport function hasClass(el: Element | null, cls: string) {\n  if (!el || !cls) return false;\n  if (cls.indexOf(\" \") !== -1)\n    throw new Error(\"className should not contain space.\");\n  if (el.classList) {\n    return el.classList.contains(cls);\n  } else {\n    return (\" \" + el.className + \" \").indexOf(\" \" + cls + \" \") > -1;\n  }\n}\n\nexport function addClass(el: Element | null, cls: string) {\n  if (!el) return;\n  var curClass = el.className;\n  var classes = (cls || \"\").split(\" \");\n\n  for (var i = 0, j = classes.length; i < j; i++) {\n    var clsName = classes[i];\n    if (!clsName) continue;\n\n    if (el.classList) {\n      el.classList.add(clsName);\n    } else if (!hasClass(el, clsName)) {\n      curClass += \" \" + clsName;\n    }\n  }\n  if (!el.classList) {\n    el.className = curClass;\n  }\n}\n\nexport function removeClass(el: Element | null, cls: string) {\n  if (!el || !cls) return;\n  var classes = cls.split(\" \");\n  var curClass = \" \" + el.className + \" \";\n\n  for (var i = 0, j = classes.length; i < j; i++) {\n    var clsName = classes[i];\n    if (!clsName) continue;\n\n    if (el.classList) {\n      el.classList.remove(clsName);\n    } else if (hasClass(el, clsName)) {\n      curClass = curClass.replace(\" \" + clsName + \" \", \" \");\n    }\n  }\n  if (!el.classList) {\n    el.className = trim(curClass);\n  }\n}\n\nconst ACode = \"A\".charCodeAt(0);\n\nexport function toIndex(columnName:string) {\n  let index = 0;\n  let charsLenght = columnName.length;\n  for(let i = 0; i < charsLenght; i++){\n    index += (columnName.charCodeAt(0) - ACode + 1) * Math.pow(26, charsLenght - i - 1);\n  }\n\n  return index;\n}\n\nexport function toName(index: number) {\n  let columnName = \"\";\n  index--;\n  do {\n    if(columnName.length > 0) {\n      index --;\n    } \n    columnName = String.fromCharCode(index % 26 + ACode) + columnName;\n    index = (index - index % 26) / 26;\n  } while(index > 0);\n  return columnName;\n}","import React, { FunctionComponent, useCallback, useRef } from \"react\";\nimport styled from \"styled-components\";\nimport { Formik, FormikProps, FormikValues, Field, ErrorMessage } from \"formik\";\nimport * as Yup from \"yup\";\n\nimport pluginFunction from \"../../assets/plugin-function.svg\";\nimport {\n  ToolbarCell,\n  IconsContainer,\n  IconsImage,\n  IPluginProps\n} from \"../Component/Toolbar\";\nimport useStore, {\n  IState,\n  IAction,\n  ActionType,\n  DataType,\n  IFunctionDataValue\n} from \"../Store\";\nimport { PLUGIN_TYPE } from \".\";\nimport Modal from \"../Component/Modal\";\nimport { ISelection } from \"../Component/Selection\";\nimport { toIndex } from \"../../common/utils\";\n\nexport type IStateBase = {\n  functionstate?: {\n    selection?: ISelection;\n    initialValues: any,\n    openDialog?: boolean;\n  };\n};\n\nconst initialValues = { type: \"sum\", begin: \"\", end: \"\" };\n\nconst emptySelection: ISelection = [-1, -1, -1, -1];\n\nconst state = {\n  functionstate: {\n    openDialog: false,\n    initialValues: initialValues,\n    selection: emptySelection\n  }\n};\n\nexport type pluginaction = \"FUNCTION_DEFAULT_ACTION\";\n\nconst actions = {\n  FUNCTION_DEFAULT_ACTION: \"FUNCTION_DEFAULT_ACTION\",\n  FUNCTION_CLOSE_MODAL_ACTION: \"FUNCTION_CLOSE_MODAL_ACTION\",\n  FUNCTION_SAVE_ACTION: \"FUNCTION_SAVE_ACTION\"\n};\nconst regForCellName = /^([A-Z]+)([1-9]+[0-9]*)$/;\nconst convertData = (functionDataValue: IFunctionDataValue) => {\n  let params;\n  switch (functionDataValue.type) {\n    case \"sum\":\n      params = functionDataValue.params.map((area: string[]) =>\n        area.map(point => {\n          let matches = point.match(regForCellName);\n          if (matches) {\n            return [toIndex(matches[1]), ~~matches[2]];\n          } else {\n            return null;\n          }\n        })\n      );\n  }\n\n  return {\n    type: functionDataValue.type,\n    params,\n    original: functionDataValue.original\n  };\n};\n\nconst reducer = (state: IState, { payload }: IAction) => {\n  switch (payload.pluginAction) {\n    case actions.FUNCTION_DEFAULT_ACTION:\n      const cellInitialValues = payload.initialValues || initialValues;\n\n      return {\n        ...state,\n        settings: {\n          ...state.settings,\n          disablekeyboardMonitoring: true\n        },\n        functionstate: {\n          openDialog: true,\n          initialValues: cellInitialValues,\n          selection: payload.selection\n        }\n      };\n    case actions.FUNCTION_CLOSE_MODAL_ACTION:\n      return {\n        ...state,\n        settings: {\n          ...state.settings,\n          disablekeyboardMonitoring: false\n        },\n        functionstate: {\n          openDialog: false,\n          initialValues,\n          selection: emptySelection\n        }\n      };\n    case actions.FUNCTION_SAVE_ACTION:\n      const { value } = payload;\n      const [startRowIndex, startCellIndex] = state.functionstate!\n        .selection as ISelection;\n\n      let extendData = {\n        [`${startCellIndex + 1}:${startRowIndex + 1}`]: {\n          type: DataType.Function,\n          value: convertData(value)\n        }\n      };\n\n      return {\n        ...state,\n        settings: {\n          ...state.settings,\n          disablekeyboardMonitoring: false\n        },\n        functionstate: {\n          openDialog: false,\n          initialValues,\n          selection: emptySelection\n        },\n        data: {\n          ...state.data,\n          ...extendData\n        }\n      };\n  }\n  return state;\n};\n\nconst getDisable = ({ isInputMode, selection }: IPluginProps) => {\n  return isInputMode || selection![0] === -1;\n};\n\nconst schema = Yup.object().shape({\n  begin: Yup.string()\n    .matches(/^[A-Z]+[1-9]+[0-9]*$/, \" (A1,B2, AA1, ...)\")\n    .required(\"\"),\n  end: Yup.string()\n    .matches(/^[A-Z]+[1-9]+[0-9]*$/, \" (A1,B2, AA1, ...)\")\n    .required(\"\")\n});\n\nconst Component: FunctionComponent<IPluginProps> = props => {\n  const isDisable = getDisable(props);\n  const formRef = useRef<Formik>(null);\n  const [state, dispath] = useStore();\n\n  const openDialog = state.functionstate!.openDialog;\n  const onClose = useCallback(() => {\n    dispath({\n      type: ActionType.PluginAction,\n      payload: {\n        pluginType: PLUGIN_TYPE.FUNCTION,\n        pluginAction: actions.FUNCTION_CLOSE_MODAL_ACTION\n      }\n    });\n  }, [dispath]);\n  const onSure = useCallback(() => {\n    if (formRef.current) {\n      formRef.current.submitForm();\n    }\n  }, []);\n  const onSumbit = useCallback(values => {\n    dispath({\n      type: ActionType.PluginAction,\n      payload: {\n        pluginType: PLUGIN_TYPE.FUNCTION,\n        pluginAction: actions.FUNCTION_SAVE_ACTION,\n        value: {\n          type: values.type,\n          params: [[values.begin, values.end]],\n          original:values\n        }\n      }\n    });\n  }, [dispath]);\n  return (\n    <>\n      <ToolbarCell\n        disable={isDisable}\n        onClick={props.action(\n          PLUGIN_TYPE.FUNCTION,\n          actions.FUNCTION_DEFAULT_ACTION\n        )}\n      >\n        <IconsContainer size={[32, 32]}>\n          <IconsImage src={pluginFunction} />\n        </IconsContainer>\n        \n      </ToolbarCell>\n      {openDialog && (\n        <Modal\n          title=\"\"\n          height={300}\n          width={600}\n          onClose={onClose}\n          onSure={onSure}\n        >\n          <ModalContent>\n            <Formik\n              ref={formRef}\n              initialValues={state.functionstate!.initialValues}\n              onSubmit={onSumbit}\n              validationSchema={schema}\n            >\n              {(props: FormikProps<FormikValues>) => (\n                <form onSubmit={props.handleSubmit}>\n                  <h3>:</h3>\n                  <Field component=\"select\" name=\"type\">\n                    <option value=\"sum\">SUM</option>\n                  </Field>\n                  <div>\n                    <h4>:</h4>\n                    <Field type=\"text\" name=\"begin\" placeholder=\"A1\" />\n                    <ErrorContainer>\n                      <ErrorMessage name=\"begin\" />\n                    </ErrorContainer>\n                  </div>\n                  <div>\n                    <h4>:</h4>\n                    <Field type=\"text\" name=\"end\" placeholder=\"B5\" />\n                    <ErrorContainer>\n                      <ErrorMessage name=\"end\" />\n                    </ErrorContainer>\n                  </div>\n                </form>\n              )}\n            </Formik>\n          </ModalContent>\n        </Modal>\n      )}\n    </>\n  );\n};\n\nconst ModalContent: any = styled.div`\n  padding: 1px 20px;\n  overflow-y: auto;\n`;\n\nconst ErrorContainer: any = styled.span`\n  color: red;\n  margin-left: 10px;\n`;\n\nexport default {\n  Component,\n  reducer,\n  state,\n  actions\n};\n","import {\n  default as PluginFunction,\n  pluginaction as FunctionAction,\n  IStateBase as IFuntionStateBase\n} from \"./Function\";\nimport {\n  default as PluginColSort,\n  pluginaction as ColSortAction\n} from \"./ColSort\";\nimport {\n  default as PluginRowSort,\n  pluginaction as RowSortAction\n} from \"./RowSort\";\n\nexport enum PLUGIN_TYPE {\n  FUNCTION = \"function\",\n  COL_SORT = \"colsort\",\n  ROW_SORT = \"rowsort\"\n}\n\nexport type IPluginState = IFuntionStateBase;\n\nexport type PLUGIN_ACTION =\n  | FunctionAction\n  | ColSortAction\n  | RowSortAction\n  | string;\n\nexport default {\n  [PLUGIN_TYPE.FUNCTION]: PluginFunction,\n  [PLUGIN_TYPE.COL_SORT]: PluginColSort,\n  [PLUGIN_TYPE.ROW_SORT]: PluginRowSort\n};\n","import React, { FunctionComponent } from \"react\";\nimport _ from \"lodash\";\nimport pluginSortAsc from \"../../assets/plugin-sort-asc.svg\";\nimport pluginSortDesc from \"../../assets/plugin-sort-desc.svg\";\nimport {\n  ToolbarCell,\n  IconsContainer,\n  IconsImage,\n  ToolbarCellContainer,\n  ToolbarCellContainerHeader,\n  IPluginProps\n} from \"../Component/Toolbar\";\nimport { PLUGIN_TYPE } from \"../Plugin\";\nimport { IState, IAction, IData } from \"../Store\";\n\n\n\nconst state = {};\n\nexport type pluginaction = \"COL_SORT_DEFAULT_ACTION\" | \"COL_SORT_DEFAULT_ACTION_DESC\"\n\nconst actions = {\n  COL_SORT_DEFAULT_ACTION: \"COL_SORT_DEFAULT_ACTION\",\n  COL_SORT_DEFAULT_ACTION_DESC: \"COL_SORT_DEFAULT_ACTION_DESC\"\n};\n\nconst reducer = (\n  state: IState,\n  {\n    payload: {\n      pluginAction,\n      selection: [startRowIndex, startCellIndex, endRowIndex, endCellIndex]\n    }\n  }: IAction\n) => {\n  let d = {\n    ...state.data\n  };\n\n  let arr: Array<Array<IData>> = [];\n  let colStart = startCellIndex + 1;\n  let colEnd = endCellIndex + 1;\n  let rowStart = startRowIndex + 1;\n  let rowEnd = endRowIndex + 1;\n\n  // sort\n  for (let col = colStart; col <= colEnd; col++) {\n    let colarr = [];\n    for (let row = rowStart; row <= rowEnd; row++) {\n      let value = d[`${col}:${row}`];\n      value && colarr.push(value);\n    }\n    colarr = _.sortBy(colarr, [\"value\"]);\n    if (pluginAction === actions.COL_SORT_DEFAULT_ACTION_DESC) {\n      colarr.reverse();\n    }\n    arr.push(colarr);\n  }\n\n  // save\n  for (let col = colStart; col <= colEnd; col++) {\n    for (let row = rowStart; row <= rowEnd; row++) {\n      let value = arr[col - colStart][row - rowStart];\n      if (value) {\n        d[`${col}:${row}`] = value;\n      } else {\n        delete d[`${col}:${row}`];\n      }\n    }\n  }\n\n  return {\n    ...state,\n    data: d\n  };\n};\n\nconst getDisable = ({ isInputMode, selection }: IPluginProps) => {\n  return isInputMode || selection![0] === -1;\n};\n\nconst Component: FunctionComponent<IPluginProps> = props => {\n  const isDisable = getDisable(props);\n  return (\n    <ToolbarCellContainer>\n      <ToolbarCellContainerHeader></ToolbarCellContainerHeader>\n      <ToolbarCell\n        disable={isDisable}\n        onClick={props.action(\n          PLUGIN_TYPE.COL_SORT,\n          actions.COL_SORT_DEFAULT_ACTION\n        )}\n      >\n        <IconsContainer size={[16, 16]}>\n          <IconsImage src={pluginSortAsc} />\n        </IconsContainer>\n        \n      </ToolbarCell>\n      <ToolbarCell\n        disable={isDisable}\n        onClick={props.action(\n          PLUGIN_TYPE.COL_SORT,\n          actions.COL_SORT_DEFAULT_ACTION_DESC\n        )}\n      >\n        <IconsContainer size={[16, 16]}>\n          <IconsImage src={pluginSortDesc} />\n        </IconsContainer>\n        \n      </ToolbarCell>\n    </ToolbarCellContainer>\n  );\n};\n\nexport default {\n  Component,\n  state,\n  reducer,\n  actions\n};\n","import React, { FunctionComponent } from \"react\";\nimport _ from \"lodash\";\nimport pluginSortAsc from \"../../assets/plugin-sort-asc.svg\";\nimport pluginSortDesc from \"../../assets/plugin-sort-desc.svg\";\nimport {\n  ToolbarCell,\n  IconsContainer,\n  IconsImage,\n  ToolbarCellContainer,\n  ToolbarCellContainerHeader,\n  IPluginProps\n} from \"../Component/Toolbar\";\nimport { PLUGIN_TYPE } from \"../Plugin\";\nimport { IState, IAction, IData } from \"../Store\";\n\nconst state = {};\n\nexport type pluginaction = \"ROW_SORT_DEFAULT_ACTION\" | \"ROW_SORT_DEFAULT_ACTION_DESC\"\n\nconst actions = {\n  ROW_SORT_DEFAULT_ACTION: \"ROW_SORT_DEFAULT_ACTION\",\n  ROW_SORT_DEFAULT_ACTION_DESC: \"ROW_SORT_DEFAULT_ACTION_DESC\"\n};\n\nconst reducer = (\n  state: IState,\n  {\n    payload: {\n      pluginAction,\n      selection: [startRowIndex, startCellIndex, endRowIndex, endCellIndex]\n    }\n  }: IAction\n) => {\n  let d = {\n    ...state.data\n  };\n\n  let arr: Array<Array<IData>> = [];\n  let colStart = startCellIndex + 1;\n  let colEnd = endCellIndex + 1;\n  let rowStart = startRowIndex + 1;\n  let rowEnd = endRowIndex + 1;\n\n  // sort\n  for (let row = rowStart; row <= rowEnd; row++) {\n    let rowarr = [];\n    for (let col = colStart; col <= colEnd; col++) {\n      let value = d[`${col}:${row}`];\n      value && rowarr.push(value);\n    }\n    rowarr = _.sortBy(rowarr, ['value']);\n    if (pluginAction === actions.ROW_SORT_DEFAULT_ACTION_DESC) {\n      rowarr.reverse();\n    }\n    arr.push(rowarr);\n  }\n\n  // save\n  for (let row = rowStart; row <= rowEnd; row++) {\n    for (let col = colStart; col <= colEnd; col++) {\n      let value = arr[row - rowStart][col - colStart];\n      if (value) {\n        d[`${col}:${row}`] = value;\n      } else {\n        delete d[`${col}:${row}`];\n      }\n    }\n  }\n\n  return {\n    ...state,\n    data: d\n  };\n};\n\nconst getDisable = ({ isInputMode, selection }: IPluginProps) => {\n  return isInputMode || selection![0] === -1;\n};\n\nconst Component: FunctionComponent<IPluginProps> = props => {\n  const isDisable = getDisable(props);\n  return (\n    <ToolbarCellContainer>\n      <ToolbarCellContainerHeader></ToolbarCellContainerHeader>\n      <ToolbarCell\n        disable={isDisable}\n        onClick={props.action(PLUGIN_TYPE.ROW_SORT, actions.ROW_SORT_DEFAULT_ACTION)}\n      >\n        <IconsContainer size={[16, 16]}>\n          <IconsImage src={pluginSortAsc} />\n        </IconsContainer>\n        \n      </ToolbarCell>\n      <ToolbarCell\n        disable={isDisable}\n        onClick={props.action(PLUGIN_TYPE.ROW_SORT, actions.ROW_SORT_DEFAULT_ACTION_DESC)}\n      >\n        <IconsContainer size={[16, 16]}>\n          <IconsImage src={pluginSortDesc} />\n        </IconsContainer>\n        \n      </ToolbarCell>\n    </ToolbarCellContainer>\n  );\n};\n\nexport default {\n  Component,\n  state,\n  reducer,\n  actions\n};\n","import React, {\n  useReducer,\n  useContext,\n  FunctionComponent,\n  Dispatch,\n  PropsWithChildren\n} from \"react\";\n\nimport Plugins, { PLUGIN_TYPE, PLUGIN_ACTION, IPluginState } from \"../Plugin\";\n\nexport enum ActionType {\n  Update = \"update\",\n  Delete = \"delete\",\n  PluginAction = \"pluginAction\"\n}\n\nexport enum DataType {\n  Number,\n  String,\n  Function\n}\nexport interface IFunctionDataValue {\n  type: string;\n  params: any;\n  original?: any\n}\nexport interface IData {\n  type: DataType;\n  value: string | IFunctionDataValue;\n}\n\nexport type IStateBase = {\n  data: { [key: string]: IData };\n  settings: {\n    disablekeyboardMonitoring: boolean;\n    plugins: string[];\n  };\n};\n\nexport type IState = IStateBase & IPluginState;\n\nexport interface IAction {\n  type: ActionType;\n  payload: {\n    pluginType?: PLUGIN_TYPE;\n    pluginAction?: PLUGIN_ACTION;\n    [key: string]: any;\n  };\n}\n\nlet pluginState = {};\n\nObject.keys(Plugins).forEach(type => {\n  pluginState = { ...pluginState, ...Plugins[type as PLUGIN_TYPE].state };\n});\n\nconst initialState: IState = {\n  data: {},\n  settings: {\n    disablekeyboardMonitoring: false,\n    plugins: [PLUGIN_TYPE.FUNCTION, PLUGIN_TYPE.COL_SORT, PLUGIN_TYPE.ROW_SORT]\n  },\n  ...pluginState\n};\n\nconst reducer: React.Reducer<IState, IAction> = (state, action) => {\n  let newData: IState;\n  switch (action.type) {\n    case ActionType.Update:\n      let key = action.payload.key as string;\n      let value = action.payload.value as IData;\n      return {\n        ...state,\n        data: {\n          ...state.data,\n          ...{ [key]: value }\n        }\n      };\n    case ActionType.Delete:\n      newData = { ...state, data: { ...state.data } };\n      let keys = action.payload.keys as string[];\n      keys.forEach(key => {\n        if (newData.data[key]) {\n          delete newData.data[key];\n        }\n      });\n      return newData;\n    case ActionType.PluginAction:\n      return Plugins[action.payload.pluginType as PLUGIN_TYPE].reducer(\n        state,\n        action\n      );\n    default:\n      throw new Error();\n  }\n};\n\nconst DataContext = React.createContext<[IState, Dispatch<IAction>]>([\n  initialState,\n  () => {}\n]);\n\nexport const DataProvider: FunctionComponent<PropsWithChildren<{}>> = ({\n  children\n}) => {\n  const contextValue = useReducer<React.Reducer<IState, IAction>>(\n    reducer,\n    initialState\n  );\n  return (\n    <DataContext.Provider value={contextValue}>{children}</DataContext.Provider>\n  );\n};\n\nconst useStore = () => {\n  const contextValue = useContext(DataContext);\n  return contextValue;\n};\n\nexport default useStore;\n","import React, { FunctionComponent, useCallback } from \"react\";\nimport styled from \"styled-components\";\nimport cls from \"classnames\";\nimport {\n  SheetRowsCount,\n  SheetCellsCount,\n  CellHeight,\n  CellWidth\n} from \"../Constants\";\nimport useStore, { DataType, IFunctionDataValue } from \"../Store\";\n\ninterface IGridValuesProps {\n  pageRowIndex: number;\n  pageCellIndex: number;\n}\n\nconst GridValues: FunctionComponent<IGridValuesProps> = ({\n  pageRowIndex,\n  pageCellIndex\n}) => {\n  const [state] = useStore();\n  const { data: storeData } = state;\n  const getFunctionValue = useCallback(\n    ({ type, params }: IFunctionDataValue) => {\n      try {\n        switch (type) {\n          case \"sum\":\n            let total = 0;\n            for (let areaIndex = 0; areaIndex < params.length; areaIndex++) {\n              let [start, end] = params[areaIndex];\n              if (start === null || end === null) {\n                return \"Error\";\n              }\n              let [scindex, srindex] = start;\n              let [ecindex, erindex] = end;\n              if (scindex > ecindex) {\n                scindex ^= ecindex;\n                ecindex ^= scindex;\n                scindex ^= ecindex;\n              }\n              if (srindex > erindex) {\n                srindex ^= erindex;\n                erindex ^= srindex;\n                srindex ^= erindex;\n              }\n\n              for (let rowindex = srindex; rowindex <= erindex; rowindex++) {\n                for (\n                  let cellindex = scindex;\n                  cellindex <= ecindex;\n                  cellindex++\n                ) {\n                  let cellData = storeData[`${cellindex}:${rowindex}`];\n                  if (cellData) {\n                    if (cellData.type === DataType.Number) {\n                      total += Number(cellData.value);\n                    }\n                  }\n                }\n              }\n            }\n            return total;\n          default:\n            return \"Error\";\n        }\n      } catch {\n        return \"Error\";\n      }\n    },\n    [storeData]\n  );\n  return (\n    <GridValuesContainer>\n      {new Array(SheetRowsCount).fill(null).map((value, rowIndex) => {\n        let rowNumber = pageRowIndex * SheetRowsCount + rowIndex + 1;\n        return (\n          <GridRow key={`grid-value-row-${rowNumber}`}>\n            {new Array(SheetCellsCount).fill(null).map((value, cellIndex) => {\n              let cellNumber = pageCellIndex * SheetCellsCount + cellIndex + 1;\n              let data = state.data[`${cellNumber}:${rowNumber}`];\n              return (\n                data && (\n                  <GridCell\n                    className={cls(\n                      data.type === DataType.Function ? `function-data` : \"\"\n                    )}\n                    key={`${cellNumber}:${rowNumber}`}\n                    id={`value-cell-${cellNumber}-${rowNumber}`}\n                    style={{\n                      left: `${cellIndex * CellWidth}px`\n                    }}\n                  >\n                    {data.type === DataType.Function\n                      ? getFunctionValue(data.value as IFunctionDataValue)\n                      : data.value}\n                  </GridCell>\n                )\n              );\n            })}\n          </GridRow>\n        );\n      })}\n    </GridValuesContainer>\n  );\n};\n\nexport default GridValues;\n\nconst GridValuesContainer: any = styled.div`\n  height: 100%;\n  width: 100%;\n`;\n\nconst GridRow: any = styled.div`\n  position: relative;\n  height: ${CellHeight}px;\n`;\nconst GridCell: any = styled.div`\n  position: absolute;\n  top: 0;\n  width: ${CellWidth - 1}px;\n  height: ${CellHeight}px;\n  line-height: ${CellHeight}px;\n  padding: 0 2px 0 1px;\n  box-sizing: border-box;\n  font-size: 12px;\n  overflow: hidden;\n  &.function-data {\n    background: #c7d6ce;\n  }\n`;\n","import React, { FunctionComponent } from \"react\";\nimport styled from \"styled-components\";\n\nimport {\n  PageHorizontalSize,\n  PageVerticalSize,\n  CellWidth,\n  CellHeight,\n  SheetRowsCount,\n  SheetCellsCount\n} from \"../Constants\";\nimport GridHorizontalLine from \"./GridHorizontalLine\";\nimport GridVirtualLine from \"./GridVirtualLine\";\nimport GridValues from \"./GridValues\";\n\ninterface IVirtualPagerCell {\n  pageHorizontalIndex: number;\n  pageVerticalIndex: number;\n}\n\nconst VirtualPagerCell: FunctionComponent<IVirtualPagerCell> = ({\n  pageVerticalIndex,\n  pageHorizontalIndex\n}) => {\n  return (\n    <StyledVirtualPagerCell>\n      <GridHorizontalLine\n        sheetRowIndex={pageVerticalIndex}\n        sheetCellIndex={pageHorizontalIndex}\n        rows={SheetRowsCount}\n        size={CellHeight}\n      />\n      <GridVirtualLine\n        sheetRowIndex={pageVerticalIndex}\n        sheetCellIndex={pageHorizontalIndex}\n        cells={SheetCellsCount}\n        size={CellWidth}\n      />\n      <GridValues\n        pageRowIndex={pageVerticalIndex}\n        pageCellIndex={pageHorizontalIndex}\n      />\n    </StyledVirtualPagerCell>\n  );\n};\n\nexport default VirtualPagerCell;\n\nconst StyledVirtualPagerCell: any = styled.div<IVirtualPagerCell>`\n  float: left;\n  height: ${PageVerticalSize}px;\n  width: ${PageHorizontalSize}px;\n  position: relative;\n`;\n","import React, { FunctionComponent } from \"react\";\nimport styled from \"styled-components\";\n\nimport {\n  PageVerticalSize,\n  PageHorizontalSize,\n  DirectionType\n} from \"../Constants\";\nimport PlaceHolder from \"./PlaceHolder\";\nimport VirtualPagerCell from \"./VirtualPagerCell\";\n\ninterface IVirtualPagerRow {\n  key?: string;\n  pageVerticalIndex: number;\n  pageHorizontalIndex: number;\n  perLoadHorizontalCount: number;\n  rearLoadHorizontalCount: number;\n}\n\nconst VirtualPagerRow: FunctionComponent<IVirtualPagerRow> = ({\n  pageVerticalIndex,\n  pageHorizontalIndex,\n  perLoadHorizontalCount,\n  rearLoadHorizontalCount,\n  ...rest\n}) => {\n  return (\n    <StyledVirtualPagerRow {...rest}>\n      <PlaceHolder\n        type={DirectionType.Horizontal}\n        size={\n          pageHorizontalIndex - perLoadHorizontalCount > 0\n            ? (pageHorizontalIndex - perLoadHorizontalCount) *\n              PageHorizontalSize\n            : 0\n        }\n      />\n      <div>\n        {new Array(perLoadHorizontalCount).fill(null).map((value, index) => {\n          let count = perLoadHorizontalCount - index;\n          return (\n            pageHorizontalIndex - count >= 0 && (\n              <VirtualPagerCell\n                key={`perload-${pageHorizontalIndex - count}`}\n                pageVerticalIndex={pageVerticalIndex}\n                pageHorizontalIndex={pageHorizontalIndex - count}\n              />\n            )\n          );\n        })}\n        <VirtualPagerCell\n          key={`current-${pageHorizontalIndex}`}\n          pageVerticalIndex={pageVerticalIndex}\n          pageHorizontalIndex={pageHorizontalIndex}\n        />\n        {new Array(rearLoadHorizontalCount).fill(null).map((value, index) => {\n          let count = index + 1;\n          return (\n            <VirtualPagerCell\n              key={`rearload-${pageHorizontalIndex + count}`}\n              pageVerticalIndex={pageVerticalIndex}\n              pageHorizontalIndex={pageHorizontalIndex + count}\n            />\n          );\n        })}\n      </div>\n    </StyledVirtualPagerRow>\n  );\n};\n\nexport default VirtualPagerRow;\n\nconst StyledVirtualPagerRow: any = styled.div`\n  height: ${PageVerticalSize}px;\n  width: 100%;\n  display: flex;\n`;\n","import React, { FunctionComponent } from \"react\";\nimport styled, { css } from \"styled-components\";\nimport {\n  DirectionType,\n  CellHeight,\n  CellWidth,\n  HeaderHorizontalSize\n} from \"../Constants\";\n\ninterface IHeaderCellProps {\n  type: DirectionType;\n  value: string;\n  className?: string;\n}\n\nconst HeaderCell: FunctionComponent<IHeaderCellProps> = ({\n  value,\n  ...rest\n}) => {\n  return <StyledHeaderCell {...rest}>{value}</StyledHeaderCell>;\n};\n\nexport default HeaderCell;\n\ninterface IStyledHeaderCellProps {\n  type: DirectionType;\n}\nconst StyledHeaderCell: any = styled.div<IStyledHeaderCellProps>`\n  position: relative;\n  font-size: 12px;\n  text-align: center;\n  height: ${(props: IStyledHeaderCellProps) =>\n    props.type === DirectionType.Virtual ? CellHeight : HeaderHorizontalSize}px;\n  line-height: ${(props: IStyledHeaderCellProps) =>\n    props.type === DirectionType.Virtual ? CellHeight : HeaderHorizontalSize}px;\n  &:before {\n    content: \"\";\n    position: absolute;\n    background: #dfdfdf;\n  }\n  &:after {\n    position: absolute;\n    background: #217346;\n  }\n\n  &.selection {\n    color: #217346;\n    font-weight: bold;\n    background: #dad8d6;\n    &:before {\n      background: #bfbfbf;\n    }\n    &:after {\n      content: \"\";\n    }\n  }\n  ${(props: IStyledHeaderCellProps) =>\n    props.type === DirectionType.Virtual\n      ? css`\n          &:before {\n            left: 0;\n            bottom: 0;\n            width: 100%;\n            height: 1px;\n          }\n          &.selection:after {\n            right: -1px;\n            top: -2px;\n            bottom: -1px;\n            width: 2px;\n          }\n        `\n      : css`\n          width: ${CellWidth}px;\n          &:before {\n            top: 0;\n            right: 0;\n            height: 100%;\n            width: 1px;\n          }\n          &.selection:after {\n            bottom: 0px;;\n            left: -2px;\n            right: -1px;\n            height: 2px;\n          }\n        `}\n`;\n","import React, { FunctionComponent } from \"react\";\nimport styled from \"styled-components\";\nimport {\n  PageHorizontalSize,\n  DirectionType,\n  HeaderVerticalSize,\n  HeaderHorizontalSize,\n  SheetCellsCount\n} from \"../Constants\";\nimport { defaultScrollWidth, toName } from \"../../common/utils\";\nimport PlaceHolder from \"./PlaceHolder\";\nimport HeaderCell from \"./HeaderCell\";\n\ninterface IHeaderHorizontalProps {\n  headerRef: React.RefObject<HTMLDivElement>;\n  pageHorizontalIndex: number;\n  perLoadHorizontalCount: number;\n  rearLoadHorizontalCount: number;\n  selectionStart: number;\n  selectionEnd: number;\n}\nconst HeaderHorizontal: FunctionComponent<IHeaderHorizontalProps> = ({\n  headerRef,\n  pageHorizontalIndex,\n  perLoadHorizontalCount,\n  rearLoadHorizontalCount\n}) => {\n  return (\n    <HeaderHorizontalContainer>\n      <HeaderCorner className={\"header-corner\"} />\n      <HeaderContainer ref={headerRef}>\n        <div\n          style={{\n            width:\n              (pageHorizontalIndex + rearLoadHorizontalCount + 1) *\n              PageHorizontalSize\n          }}\n        >\n          <StyledPlaceHolder\n            type={DirectionType.Horizontal}\n            size={\n              pageHorizontalIndex - perLoadHorizontalCount > 0\n                ? (pageHorizontalIndex - perLoadHorizontalCount) *\n                  PageHorizontalSize\n                : 0\n            }\n          />\n          <CellsContainer>\n            {new Array(perLoadHorizontalCount)\n              .fill(null)\n              .map((value, index) => {\n                let count = perLoadHorizontalCount - index;\n                let pageIndex = pageHorizontalIndex - count;\n                return (\n                  pageHorizontalIndex - count >= 0 && (\n                    <HeaderPager\n                      key={`perload-${pageIndex}`}\n                      data-key={`perload-${pageIndex}`}\n                    >\n                      {new Array(SheetCellsCount)\n                        .fill(null)\n                        .map((value, index) => {\n                          let keyIndex =\n                            pageIndex * SheetCellsCount + index + 1;\n                          return (\n                            <HeaderCell\n                              key={`horizontal-header-cell-${keyIndex}`}\n                              className={`horizontal-header-cell-${keyIndex}`}\n                              type={DirectionType.Horizontal}\n                              value={toName(keyIndex)}\n                            />\n                          );\n                        })}\n                    </HeaderPager>\n                  )\n                );\n              })}\n            <HeaderPager\n              key={`current-${pageHorizontalIndex}`}\n              data-key={`current-${pageHorizontalIndex}`}\n            >\n              {new Array(SheetCellsCount).fill(null).map((value, index) => {\n                let keyIndex =\n                  pageHorizontalIndex * SheetCellsCount + index + 1;\n                return (\n                  <HeaderCell\n                    key={`horizontal-header-cell-${keyIndex}`}\n                    className={`horizontal-header-cell-${keyIndex}`}\n                    type={DirectionType.Horizontal}\n                    value={toName(keyIndex)}\n                  />\n                );\n              })}\n            </HeaderPager>\n            {new Array(rearLoadHorizontalCount)\n              .fill(null)\n              .map((value, index) => {\n                let count = index + 1;\n                let pageIndex = pageHorizontalIndex + count;\n                return (\n                  <HeaderPager\n                    key={`rearload-${pageIndex}`}\n                    data-key={`rearload-${pageIndex}`}\n                  >\n                    {new Array(SheetCellsCount)\n                      .fill(null)\n                      .map((value, index) => {\n                        let keyIndex = pageIndex * SheetCellsCount + index + 1;\n                        return (\n                          <HeaderCell\n                            key={`horizontal-header-cell-${keyIndex}`}\n                            className={`horizontal-header-cell-${keyIndex}`}\n                            type={DirectionType.Horizontal}\n                            value={toName(keyIndex)}\n                          />\n                        );\n                      })}\n                  </HeaderPager>\n                );\n              })}\n          </CellsContainer>\n        </div>\n      </HeaderContainer>\n    </HeaderHorizontalContainer>\n  );\n};\n\nexport default HeaderHorizontal;\n\nconst StyledPlaceHolder: any = styled(PlaceHolder)`\n  float: left;\n  height: ${HeaderHorizontalSize}px;\n`;\n\nconst HeaderHorizontalContainer: any = styled.div`\n  width: 100%;\n  background: #edebe9;\n  position: relative;\n`;\nconst HeaderCorner: any = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  box-sizing: border-box;\n  width: ${HeaderVerticalSize}px;\n  height: ${HeaderHorizontalSize}px;\n  border-bottom: 1px solid #dfdfdf;\n  border-right: 1px solid #dfdfdf;\n  &.selection:after {\n    content: \"\";\n    position: absolute;\n    right: -1px;\n    bottom: -1px;\n    height: 2px;\n    width: 2px;\n    background: #217346;\n  }\n`;\nconst HeaderContainer: any = styled.div`\n  width: calc(100% - ${HeaderVerticalSize + defaultScrollWidth}px);\n  margin-left: ${HeaderVerticalSize}px;\n  overflow: hidden;\n`;\n\nconst CellsContainer: any = styled.div`\n  overflow: hidden;\n  float: left;\n`;\n\nconst HeaderPager: any = styled.div`\n  height: ${HeaderHorizontalSize}px;\n  width: ${PageHorizontalSize}px;\n  float: left;\n  display: flex;\n`;\n","import React, { FunctionComponent } from \"react\";\nimport styled from \"styled-components\";\nimport {\n  HeaderVerticalSize,\n  PageVerticalSize,\n  DirectionType,\n  SheetRowsCount\n} from \"../Constants\";\nimport { defaultScrollWidth } from \"../../common/utils\";\nimport PlaceHolder from \"./PlaceHolder\";\nimport HeaderCell from \"./HeaderCell\";\n\ninterface IHeaderVerticalProps {\n  headerRef: React.RefObject<HTMLDivElement>;\n  pageVerticalIndex: number;\n  perLoadVerticalCount: number;\n  rearLoadVerticalCount: number;\n}\nconst HeaderVertical: FunctionComponent<IHeaderVerticalProps> = ({\n  headerRef,\n  pageVerticalIndex,\n  perLoadVerticalCount,\n  rearLoadVerticalCount\n}) => {\n  return (\n    <HeaderVerticalContainer>\n      <HeaderContainer ref={headerRef}>\n        <PlaceHolder\n          type={DirectionType.Virtual}\n          size={\n            pageVerticalIndex - perLoadVerticalCount > 0\n              ? (pageVerticalIndex - perLoadVerticalCount) * PageVerticalSize\n              : 0\n          }\n        />\n        <div>\n          {new Array(perLoadVerticalCount).fill(null).map((value, index) => {\n            let count = perLoadVerticalCount - index;\n            let pageIndex = pageVerticalIndex - count;\n            return (\n              pageIndex >= 0 && (\n                <HeaderPager\n                  key={`perload-${pageIndex}`}\n                  data-key={`perload-${pageIndex}`}\n                >\n                  {new Array(SheetRowsCount).fill(null).map((value, index) => {\n                    let keyIndex =\n                      pageVerticalIndex * SheetRowsCount + index + 1;\n                    return (\n                      <HeaderCell\n                        key={`vertical-header-cell-${keyIndex}`}\n                        className={`vertical-header-cell-${keyIndex}`}\n                        type={DirectionType.Virtual}\n                        value={`${keyIndex}`}\n                      />\n                    );\n                  })}\n                </HeaderPager>\n              )\n            );\n          })}\n          <HeaderPager\n            key={`current-${pageVerticalIndex}`}\n            data-key={`current-${pageVerticalIndex}`}\n          >\n            {new Array(SheetRowsCount).fill(null).map((value, index) => {\n              let keyIndex = pageVerticalIndex * SheetRowsCount + index + 1;\n              return (\n                <HeaderCell\n                  key={`vertical-header-cell-${keyIndex}`}\n                  className={`vertical-header-cell-${keyIndex}`}\n                  type={DirectionType.Virtual}\n                  value={`${keyIndex}`}\n                />\n              );\n            })}\n          </HeaderPager>\n          {new Array(rearLoadVerticalCount).fill(null).map((value, index) => {\n            let count = index + 1;\n            let pageIndex = pageVerticalIndex + count;\n            return (\n              <HeaderPager\n                key={`rearload-${pageIndex}`}\n                data-key={`rearload-${pageIndex}`}\n              >\n                {new Array(SheetRowsCount).fill(null).map((value, index) => {\n                  let keyIndex = pageIndex * SheetRowsCount + index + 1;\n                  return (\n                    <HeaderCell\n                      key={`vertical-header-cell-${keyIndex}`}\n                      className={`vertical-header-cell-${keyIndex}`}\n                      type={DirectionType.Virtual}\n                      value={`${keyIndex}`}\n                    />\n                  );\n                })}\n              </HeaderPager>\n            );\n          })}\n        </div>\n      </HeaderContainer>\n    </HeaderVerticalContainer>\n  );\n};\n\nexport default HeaderVertical;\n\nconst HeaderVerticalContainer: any = styled.div`\n  background: #edebe9;\n`;\n\nconst HeaderContainer: any = styled.div`\n  width: ${HeaderVerticalSize}px;\n  height: calc(100% - ${defaultScrollWidth - 1}px);\n  overflow: hidden;\n`;\n\nconst HeaderPager: any = styled.div`\n  height: ${PageVerticalSize}px;\n  width: ${HeaderVerticalSize}px;\n  border-right: solid 1px #bbb;\n  box-sizing: border-box;\n`;\n","import React, {\n  FunctionComponent,\n  useCallback,\n  useEffect,\n  useRef\n} from \"react\";\nimport styled, { css } from \"styled-components\";\nimport { CellWidth, CellHeight } from \"../Constants\";\nimport { ISelectionProps } from \"../Common\";\nimport { trim } from \"../../common/utils\";\nimport useStore from \"../Store\";\n\nexport type ISelection = [number, number, number, number];\n\ninterface ISelectionRefProps {\n  selectionRef: React.RefObject<HTMLDivElement>;\n  isInputMode: boolean;\n  exitInputMode: (value: string, rowIndex: number, cellIndex: number) => void;\n}\n\nconst Selection: FunctionComponent<ISelectionProps & ISelectionRefProps> = ({\n  selectionRef,\n  isInputMode,\n  exitInputMode,\n  startRowIndex,\n  startCellIndex\n}) => {\n  const ref = useRef<HTMLInputElement>(null);\n  const [\n    {\n      data: {\n        [`${startCellIndex + 1}:${startRowIndex + 1}`]: {\n          value: inputValue = \"\"\n        } = { value: \"\" }\n      }\n    }\n  ] = useStore();\n\n  const handleBlur = useCallback(\n    (e: FocusEvent) => {\n      let input = ref.current;\n      if (input) {\n        exitInputMode(trim(input.value), startRowIndex + 1, startCellIndex + 1);\n      }\n    },\n    // eslint-disable-next-line\n    [isInputMode]\n  );\n\n  useEffect(() => {\n    if (isInputMode && ref.current) {\n      ref.current.focus();\n      ref.current.select();\n    }\n  }, [isInputMode]);\n\n  return (\n    <>\n      <SelectionContainer ref={selectionRef} style={{ left: -9999 }}>\n        <SelectionBorder>\n          <SelectionInnerBorder />\n        </SelectionBorder>\n        <SelectionInputArea>\n          {isInputMode && (\n            <StyledInput\n              className=\"edit-mode-input\"\n              ref={ref}\n              defaultValue={inputValue}\n              onBlur={handleBlur}\n            />\n          )}\n        </SelectionInputArea>\n        <SelectionAreaTop />\n        <SelectionAreaBottom />\n      </SelectionContainer>\n    </>\n  );\n};\n\nexport default Selection;\n\nconst SelectionBorder: any = styled.div`\n  position: absolute;\n  top: -2px;\n  left: -2px;\n  right: -1px;\n  bottom: -1px;\n  border: 2px solid #217346;\n`;\n\nconst SelectionInnerBorder: any = styled.div`\n  border: 1px solid #fff;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  z-index: 1;\n`;\n\nconst commonStyle = css`\n  position: absolute;\n  right: 0;\n  background: #141414;\n  opacity: 0.24;\n`;\n\nconst SelectionInputArea: any = styled.div`\n  height: ${CellHeight - 1}px;\n  width: ${CellWidth}px;\n  position: absolute;\n  left: 0;\n  top: 0;\n`;\nconst StyledInput: any = styled.input.attrs(props => ({\n  type: \"text\"\n}))`\n  border: 0px;\n  background: #eee;\n  height: 100%;\n  width: calc(100% - 1px);\n  margin: 0;\n  line-height: ${CellHeight - 1}px;\n  padding: 0 1px;\n  outline: none;\n  box-sizing: border-box;\n  vertical-align: top;\n  font-size: 12px;\n`;\nconst SelectionAreaTop: any = styled.div`\n  ${commonStyle}\n  top: 0;\n  left: ${CellWidth - 1}px;\n  height: ${CellHeight - 1}px;\n`;\nconst SelectionAreaBottom: any = styled.div`\n  ${commonStyle}\n  top: ${CellHeight - 1}px;\n  left: 0;\n  bottom: 0;\n`;\n\nconst SelectionContainer: any = styled.div`\n  position: absolute;\n`;\n","import { useEffect } from \"react\";\nimport { PageVerticalSize, PageHorizontalSize } from \"../Constants\";\n\nconst useVirtualScrollEffect = (\n  ref: React.RefObject<HTMLElement>,\n  verticalHeaderRef: React.RefObject<HTMLElement>,\n  horizontalHeaderRef: React.RefObject<HTMLElement>,\n  verticalScrollCache: number,\n  horizontalScrollCache: number,\n  pageHorizontalIndex: number,\n  pageVerticalIndex: number,\n  updatePageHorizontalDataHander: (pageIndex: number, cacheX: number, cacheY: number) => void,\n  updatePageVerticalDataHander: (pageIndex: number, cacheX: number, cacheY: number) => void\n) => {\n  useEffect(() => {\n    let el = ref.current;\n    let vel = verticalHeaderRef.current;\n    let hel = horizontalHeaderRef.current;\n    if (el) {\n      el.scrollTop = verticalScrollCache;\n      el.scrollLeft = horizontalScrollCache;\n    }\n\n    if (vel) {\n      vel.scrollTop = verticalScrollCache;\n      vel.scrollLeft = horizontalScrollCache;\n    }\n\n    if (hel) {\n      hel.scrollTop = verticalScrollCache;\n      hel.scrollLeft = horizontalScrollCache;\n    }\n\n    let handler = (e: Event) => {\n      let container: HTMLDivElement;\n      let scrollTop: number;\n      let currentPageHorizontalIndex: number;\n      let scrollLeft: number;\n      let currentPageVerticalIndex: number;\n\n      if (e.target) {\n        container = e.target as HTMLDivElement;\n\n        //Vertical\n        scrollTop = container.scrollTop;\n        scrollLeft = container.scrollLeft;\n\n        if (verticalHeaderRef.current) {\n          verticalHeaderRef.current.scrollTop = scrollTop;\n        }\n        currentPageVerticalIndex = Math.floor(scrollTop / PageVerticalSize);\n        if (currentPageVerticalIndex !== pageVerticalIndex) {\n          updatePageVerticalDataHander(\n            currentPageVerticalIndex,\n            scrollLeft,\n            scrollTop\n          );\n        }\n\n        // Horizontal\n        if (horizontalHeaderRef.current) {\n          horizontalHeaderRef.current.scrollLeft = scrollLeft;\n        }\n        currentPageHorizontalIndex = Math.floor(\n          scrollLeft / PageHorizontalSize\n        );\n        if (currentPageHorizontalIndex !== pageHorizontalIndex) {\n          updatePageHorizontalDataHander(\n            currentPageHorizontalIndex,\n            scrollLeft,\n            scrollTop\n          );\n        }\n      }\n    };\n\n    el && el.addEventListener(\"scroll\", handler);\n\n    return () => {\n      el && el.removeEventListener(\"scroll\", handler);\n    };\n  }, [\n    ref,\n    horizontalHeaderRef,\n    verticalHeaderRef,\n    verticalScrollCache,\n    horizontalScrollCache,\n    pageHorizontalIndex,\n    pageVerticalIndex,\n    updatePageHorizontalDataHander,\n    updatePageVerticalDataHander\n  ]);\n};\n\nexport default useVirtualScrollEffect;\n","import { useEffect, RefObject } from \"react\";\nimport {\n  HeaderVerticalSize,\n  HeaderHorizontalSize,\n  ToolBarHeight,\n  CellWidth,\n  CellHeight\n} from \"../Constants\";\nimport { ISelection } from \"../Component/Selection\";\nimport { calcStyle } from \"../Common\";\nimport { addClass, removeClass, forEach } from \"../../common/utils\";\n\nconst useSelectionEffect = (\n  ref: RefObject<HTMLElement>,\n  selectionRef: RefObject<HTMLElement>,\n  setSelection: (selection: ISelection) => void,\n  deleteSelection: () => void\n) => {\n  useEffect(() => {\n    let el = ref.current;\n    let selectionEl = selectionRef.current;\n    let sRowIndex: number;\n    let sCellIndex: number;\n    let eRowIndex: number;\n    let eCellIndex: number;\n    let isHReverse: boolean;\n    let isVReverse: boolean;\n    let cacheOnselectstart: any;\n    let checkInputMode = () => !!document.querySelector(\".edit-mode-input\");\n\n    let realTimeRender = () => {\n      let { top, left, width, height } = calcStyle({\n        startRowIndex: isVReverse ? eRowIndex : sRowIndex,\n        endRowIndex: isVReverse ? sRowIndex : eRowIndex,\n        startCellIndex: isHReverse ? eCellIndex : sCellIndex,\n        endCellIndex: isHReverse ? sCellIndex : eCellIndex\n      });\n\n      if (selectionEl) {\n        selectionEl.style.top = `${top}px`;\n        selectionEl.style.left = `${left}px`;\n        selectionEl.style.width = `${width}px`;\n        selectionEl.style.height = `${height}px`;\n      }\n\n      forEach(document.querySelectorAll(\".selection\"), (el: HTMLElement) =>\n        removeClass(el, \"selection\")\n      );\n\n      let corner = document.querySelector(\".header-corner\");\n      if (sCellIndex === 0 || eCellIndex === 0) {\n        addClass(corner, \"selection\");\n      } else {\n        removeClass(corner, \"selection\");\n      }\n\n      forEach(\n        document.querySelectorAll(\n          new Array(Math.abs(eCellIndex - sCellIndex))\n            .fill(null)\n            .reduce(\n              (p, c, i) =>\n                (p += `, .horizontal-header-cell-${(isHReverse\n                  ? eCellIndex\n                  : sCellIndex) +\n                  i +\n                  2}`),\n              `.horizontal-header-cell-${(isHReverse\n                ? eCellIndex\n                : sCellIndex) + 1}`\n            )\n        ),\n        (el: HTMLElement) => addClass(el, \"selection\")\n      );\n\n      forEach(\n        document.querySelectorAll(\n          new Array(Math.abs(eRowIndex - sRowIndex))\n            .fill(null)\n            .reduce(\n              (p, c, i) =>\n                (p += `, .vertical-header-cell-${(isVReverse\n                  ? eRowIndex\n                  : sRowIndex) +\n                  i +\n                  2}`),\n              `.vertical-header-cell-${(isVReverse ? eRowIndex : sRowIndex) +\n                1}`\n            )\n        ),\n        (el: HTMLElement) => addClass(el, \"selection\")\n      );\n    };\n\n    let mouseDownHandler = (e: MouseEvent) => {\n      isHReverse = false;\n      isVReverse = false;\n      let scrollTop = el ? el.scrollTop : 0;\n      let scrollLeft = el ? el.scrollLeft : 0;\n      cacheOnselectstart = document.onselectstart;\n      document.onselectstart = () => false;\n\n      sCellIndex = eCellIndex = Math.floor(\n        (scrollLeft + e.clientX - HeaderVerticalSize) / CellWidth\n      );\n      sRowIndex = eRowIndex = Math.floor(\n        (scrollTop + e.clientY - HeaderHorizontalSize - ToolBarHeight) /\n          CellHeight\n      );\n      setSelection([sRowIndex, sCellIndex, eRowIndex, eCellIndex]);\n      realTimeRender();\n      document.removeEventListener(\"mouseup\", mouseUpHandler);\n      document.removeEventListener(\"mousemove\", mouseMoveHandler);\n      document.addEventListener(\"mousemove\", mouseMoveHandler);\n      document.addEventListener(\"mouseup\", mouseUpHandler);\n    };\n    let mouseUpHandler = (e: MouseEvent) => {\n      if (checkInputMode()) return;\n      document.onselectstart = cacheOnselectstart;\n      document.removeEventListener(\"mouseup\", mouseUpHandler);\n      document.removeEventListener(\"mousemove\", mouseMoveHandler);\n      setSelection([\n        isVReverse ? eRowIndex : sRowIndex,\n        isHReverse ? eCellIndex : sCellIndex,\n        isVReverse ? sRowIndex : eRowIndex,\n        isHReverse ? sCellIndex : eCellIndex\n      ]);\n    };\n    let mouseMoveHandler = (e: MouseEvent) => {\n      if (checkInputMode()) return;\n      let scrollTop = el ? el.scrollTop : 0;\n      let scrollLeft = el ? el.scrollLeft : 0;\n      eCellIndex = Math.floor(\n        (scrollLeft + e.clientX - HeaderVerticalSize) / CellWidth\n      );\n      eRowIndex = Math.floor(\n        (scrollTop + e.clientY - HeaderHorizontalSize - ToolBarHeight) /\n          CellHeight\n      );\n\n      eRowIndex = eRowIndex < 0 ? 0 : eRowIndex;\n      eCellIndex = eCellIndex < 0 ? 0 : eCellIndex;\n\n      isHReverse = eCellIndex < sCellIndex;\n      isVReverse = eRowIndex < sRowIndex;\n\n      realTimeRender();\n    };\n\n    el && el.addEventListener(\"mousedown\", mouseDownHandler);\n    return () => {\n      el && el.removeEventListener(\"mousedown\", mouseDownHandler);\n    };\n  }, [ref, selectionRef, setSelection]);\n\n  useEffect(() => {\n    let handler = (e: KeyboardEvent) => {\n      let keyCode = e.keyCode;\n      let el = e.target as HTMLElement;\n      if ([8, 46].includes(keyCode) && el.nodeName !== \"INPUT\") {\n        deleteSelection();\n      }\n    };\n    document.addEventListener(\"keydown\", handler);\n    return () => {\n      document.removeEventListener(\"keydown\", handler);\n    };\n  }, [deleteSelection]);\n};\n\nexport default useSelectionEffect;\n","import { CellWidth, CellHeight } from \"./Constants\";\nexport interface ISelectionProps {\n  startRowIndex: number;\n  endRowIndex: number;\n  startCellIndex: number;\n  endCellIndex: number;\n}\nexport const calcStyle = ({\n  startRowIndex,\n  endRowIndex,\n  startCellIndex,\n  endCellIndex\n}: ISelectionProps) => ({\n  display: startRowIndex === -1 ? \"none\" : \"block\",\n  top: startRowIndex * CellHeight,\n  left: startCellIndex * CellWidth,\n  width: (Math.abs(endCellIndex - startCellIndex) + 1) * CellWidth,\n  height: (Math.abs(endRowIndex - startRowIndex) + 1) * CellHeight\n});\n","import { useEffect, RefObject } from \"react\";\nimport useStore from \"../Store\";\n\nconst useModeChangeEffect = (\n  ref: RefObject<HTMLElement>,\n  enableInputMode: () => void\n) => {\n  const [\n    {\n      settings: { disablekeyboardMonitoring }\n    }\n  ] = useStore();\n  useEffect(() => {\n    let el = ref.current;\n\n    let dblClickHandler = (e: MouseEvent) => enableInputMode();\n    el && el.addEventListener(\"dblclick\", dblClickHandler);\n    return () => {\n      el && el.removeEventListener(\"dblclick\", dblClickHandler);\n    };\n  }, [ref, enableInputMode]);\n\n  useEffect(() => {\n    let handler = (e: KeyboardEvent) => {\n      let keyCode = e.keyCode;\n      if (\n        !disablekeyboardMonitoring &&\n        ((keyCode >= 48 && keyCode <= 57) || // 0 - 9\n        (keyCode >= 96 && keyCode <= 111) || // Small keyboard characters\n        (keyCode >= 65 && keyCode <= 90) || // a - z\n        (keyCode >= 186 && keyCode <= 192) || // punctuation\n          (keyCode >= 186 && keyCode <= 222)) // punctuation\n      ) {\n        enableInputMode();\n      }\n    };\n    document.addEventListener(\"keydown\", handler);\n    return () => {\n      document.removeEventListener(\"keydown\", handler);\n    };\n  }, [enableInputMode, disablekeyboardMonitoring]);\n};\n\nexport default useModeChangeEffect;\n","import { useEffect, RefObject } from \"react\";\nimport { throttle } from \"lodash\";\nimport { PageHorizontalSize, PageVerticalSize } from \"../Constants\";\n\nconst useResizeEffect = (\n  ref: RefObject<HTMLElement>,\n  updateLoadHorizontalCount: (n: number) => void,\n  updateLoadVerticalCount: (n: number) => void\n) => {\n  useEffect(() => {\n    let handler = throttle(() => {\n      let el = ref.current;\n      if (el) {\n        // Horizontal\n        let offsetWidth = el.offsetWidth;\n        if (offsetWidth < PageHorizontalSize) {\n          updateLoadVerticalCount(1);\n        } else {\n          updateLoadVerticalCount(Math.floor(offsetWidth / PageHorizontalSize));\n        }\n\n        // Vertical\n        let offsetHeight = el.offsetHeight;\n        if (offsetHeight < PageVerticalSize) {\n          updateLoadHorizontalCount(Math.ceil(offsetHeight / PageVerticalSize));\n        }\n      }\n    });\n    handler();\n    window.addEventListener(\"resize\", handler);\n    return () => {\n      window.removeEventListener(\"resize\", handler);\n    };\n  }, [ref, updateLoadHorizontalCount, updateLoadVerticalCount]);\n};\n\nexport default useResizeEffect;\n","import React, { useState, useRef, useCallback } from \"react\";\nimport ReactDom from \"react-dom\";\nimport styled from \"styled-components\";\nimport {\n  PageHorizontalSize,\n  PageVerticalSize,\n  PerLoadCountDefault,\n  RearLoadCountDefault,\n  DirectionType,\n  HeaderHorizontalSize,\n  ToolBarHeight\n} from \"./Constants\";\nimport PlaceHolder from \"./Component/PlaceHolder\";\nimport VirtualPagerRow from \"./Component/VirtualPagerRow\";\nimport HorizontalHeader from \"./Component/HeaderHorizontal\";\nimport VerticalHeader from \"./Component/HeaderVertical\";\nimport Selection, { ISelection } from \"./Component/Selection\";\nimport Toolbar from \"./Component/Toolbar\";\nimport useStore, { ActionType, DataType, IFunctionDataValue } from \"./Store\";\nimport {\n  useVirtualScrollEffect,\n  useSelectionEffect,\n  useModeChangeEffect,\n  useResizeEffect\n} from \"./Effects\";\nimport Plugins, { PLUGIN_TYPE } from \"./Plugin\";\n\nconst Editor: React.FC = (...rest: any) => {\n  const [state, dispatch] = useStore();\n  // Selection\n  const [selection, setSelection] = useState<ISelection>([-1, -1, -1, -1]);\n  const [isInputMode, setInputMode] = useState<boolean>(false);\n\n  // Vertical parameters\n  const verticalHeaderRef = useRef<HTMLDivElement>(null);\n  const [verticalScrollCache, setVerticalScrollCache] = useState<number>(0);\n  const [pageVerticalIndex, updatePageVerticalIndex] = useState<number>(0);\n  const [coefficientVertical, updateCoefficientVertical] = useState<number>(1);\n  const [perLoadVerticalCount, updatePerLoadVerticalCount] = useState<number>(\n    PerLoadCountDefault * coefficientVertical\n  );\n  const [rearLoadVerticalCount, updateRearLoadVerticalCount] = useState<number>(\n    RearLoadCountDefault * coefficientVertical\n  );\n\n  const updatePageVerticalDataHander = useCallback(\n    (pageIndex: number, cacheX: number, cacheY: number) =>\n      ReactDom.unstable_batchedUpdates(() => {\n        setHorizontalScrollCache(cacheX);\n        setVerticalScrollCache(cacheY);\n        updatePageVerticalIndex(pageIndex);\n      }),\n    []\n  );\n  const updateLoadVerticalCount = useCallback((n: number) => {\n    updateCoefficientVertical(n);\n    updatePerLoadVerticalCount(PerLoadCountDefault * n);\n    updateRearLoadVerticalCount(RearLoadCountDefault * n);\n  }, []);\n\n  // Horizontal parameters\n  const horizontalHeaderRef = useRef<HTMLDivElement>(null);\n  const [horizontalScrollCache, setHorizontalScrollCache] = useState<number>(0);\n  const [pageHorizontalIndex, updatePageHorizontalIndex] = useState<number>(0);\n  const [coefficientHorizontal, updateCoefficientHorizontal] = useState<number>(\n    1\n  );\n  const [perLoadHorizontalCount, updatePerLoadHorizontalCount] = useState<\n    number\n  >(PerLoadCountDefault * coefficientHorizontal);\n  const [rearLoadHorizontalCount, updateRearLoadHorizontalCount] = useState<\n    number\n  >(RearLoadCountDefault * coefficientHorizontal);\n\n  const updatePageHorizontalDataHander = useCallback(\n    (pageIndex: number, cacheX: number, cacheY: number) =>\n      ReactDom.unstable_batchedUpdates(() => {\n        setHorizontalScrollCache(cacheX);\n        setVerticalScrollCache(cacheY);\n        updatePageHorizontalIndex(pageIndex);\n      }),\n    []\n  );\n  const updateLoadHorizontalCount = useCallback(\n    (n: number) =>\n      ReactDom.unstable_batchedUpdates(() => {\n        updateCoefficientHorizontal(n);\n        updatePerLoadHorizontalCount(PerLoadCountDefault * n);\n        updateRearLoadHorizontalCount(RearLoadCountDefault * n);\n      }),\n    []\n  );\n\n  const ref = useRef<HTMLDivElement>(null);\n  const selectionRef = useRef<HTMLDivElement>(null);\n\n  const VirtualPagerRowProps = {\n    pageHorizontalIndex,\n    perLoadHorizontalCount,\n    rearLoadHorizontalCount\n  };\n\n  const [startRowIndex, startCellIndex, endRowIndex, endCellIndex] = selection;\n\n  const VerticalHeaderProps = {\n    headerRef: verticalHeaderRef,\n    pageVerticalIndex,\n    perLoadVerticalCount,\n    rearLoadVerticalCount,\n    selectionStart: startRowIndex,\n    selectionEnd: endRowIndex\n  };\n\n  const HorizontalHeaderProps = {\n    headerRef: horizontalHeaderRef,\n    pageHorizontalIndex,\n    perLoadHorizontalCount,\n    rearLoadHorizontalCount,\n    selectionStart: startCellIndex,\n    selectionEnd: endCellIndex\n  };\n\n  const exitInputMode = useCallback(\n    (value: string, rowNumber: number, cellNumber: number) => {\n      setInputMode(false);\n      if (value) {\n        let isNumber = !isNaN(Number(value));\n        dispatch({\n          type: ActionType.Update,\n          payload: {\n            key: `${cellNumber}:${rowNumber}`,\n            value: {\n              type: isNumber ? DataType.Number : DataType.String,\n              value: isNumber ? Number(value) : value\n            }\n          }\n        });\n      } else {\n        dispatch({\n          type: ActionType.Delete,\n          payload: {\n            keys: [`${cellNumber}:${rowNumber}`]\n          }\n        });\n      }\n    },\n    [dispatch]\n  );\n\n  const enableInputMode = useCallback(() => {\n    let cellNumber = startCellIndex + 1;\n    let rowNumber = startRowIndex + 1;\n    let data = state.data[`${cellNumber}:${rowNumber}`];\n    if (data && data.type === DataType.Function) {\n      dispatch({\n        type: ActionType.PluginAction,\n        payload: {\n          pluginType: PLUGIN_TYPE.FUNCTION,\n          pluginAction:\n            Plugins[PLUGIN_TYPE.FUNCTION].actions.FUNCTION_DEFAULT_ACTION,\n          selection: [startRowIndex, startCellIndex, endRowIndex, endCellIndex],\n          initialValues: (data.value as IFunctionDataValue).original\n        }\n      });\n    } else {\n      setInputMode(true);\n    }\n  }, [\n    setInputMode,\n    dispatch,\n    state.data,\n    startRowIndex,\n    startCellIndex,\n    endRowIndex,\n    endCellIndex\n  ]);\n\n  const deleteSelection = useCallback(() => {\n    let keys = [];\n    for (let row = startRowIndex; row <= endRowIndex; row++) {\n      for (let cell = startCellIndex; cell <= endCellIndex; cell++) {\n        keys.push(`${cell + 1}:${row + 1}`);\n      }\n    }\n    keys.length &&\n      dispatch({\n        type: ActionType.Delete,\n        payload: {\n          keys\n        }\n      });\n  }, [startRowIndex, endRowIndex, startCellIndex, endCellIndex, dispatch]);\n\n  useVirtualScrollEffect(\n    ref,\n    verticalHeaderRef,\n    horizontalHeaderRef,\n    verticalScrollCache,\n    horizontalScrollCache,\n    pageHorizontalIndex,\n    pageVerticalIndex,\n    updatePageHorizontalDataHander,\n    updatePageVerticalDataHander\n  );\n\n  useSelectionEffect(ref, selectionRef, setSelection, deleteSelection);\n\n  useModeChangeEffect(ref, enableInputMode);\n\n  useResizeEffect(ref, updateLoadHorizontalCount, updateLoadVerticalCount);\n\n  return (\n    <>\n      <Toolbar isInputMode={isInputMode} selection={selection} />\n      <TableContainer>\n        <HorizontalHeader {...HorizontalHeaderProps} />\n        <ContentContainer>\n          <VerticalHeader {...VerticalHeaderProps} />\n          <VirtualContainer ref={ref} {...rest}>\n            <PlaceHolder\n              type={DirectionType.Virtual}\n              size={\n                pageVerticalIndex - perLoadVerticalCount > 0\n                  ? (pageVerticalIndex - perLoadVerticalCount) *\n                    PageVerticalSize\n                  : 0\n              }\n            />\n            <div\n              style={{\n                width:\n                  (pageHorizontalIndex + rearLoadHorizontalCount + 1) *\n                  PageHorizontalSize\n              }}\n            >\n              {new Array(perLoadVerticalCount)\n                .fill(null)\n                .map((value, index) => {\n                  let count = perLoadVerticalCount - index;\n                  return (\n                    pageVerticalIndex - count >= 0 && (\n                      <VirtualPagerRow\n                        key={`perload-${pageVerticalIndex - count}`}\n                        data-key={`perload-${pageVerticalIndex - count}`}\n                        pageVerticalIndex={pageVerticalIndex - count}\n                        {...VirtualPagerRowProps}\n                      />\n                    )\n                  );\n                })}\n              <VirtualPagerRow\n                key={`current-${pageVerticalIndex}`}\n                data-key={`current-${pageVerticalIndex}`}\n                pageVerticalIndex={pageVerticalIndex}\n                {...VirtualPagerRowProps}\n              />\n              {new Array(rearLoadVerticalCount)\n                .fill(null)\n                .map((value, index) => {\n                  let count = index + 1;\n                  return (\n                    <VirtualPagerRow\n                      key={`rearload-${pageVerticalIndex + count}`}\n                      data-key={`rearload-${pageVerticalIndex + count}`}\n                      pageVerticalIndex={pageVerticalIndex + count}\n                      {...VirtualPagerRowProps}\n                    />\n                  );\n                })}\n            </div>\n            <Selection\n              selectionRef={selectionRef}\n              exitInputMode={exitInputMode}\n              isInputMode={isInputMode}\n              startRowIndex={startRowIndex}\n              endRowIndex={endRowIndex}\n              startCellIndex={startCellIndex}\n              endCellIndex={endCellIndex}\n            />\n          </VirtualContainer>\n        </ContentContainer>\n      </TableContainer>\n    </>\n  );\n};\nconst TableContainer: any = styled.div`\n  height: calc(100vh - ${ToolBarHeight}px);\n  width: 100vw;\n`;\n\nconst VirtualContainer: any = styled.div`\n  height: 100%;\n  width: 100%;\n  overflow: scroll;\n  position: relative;\n`;\n\nconst ContentContainer: any = styled.div`\n  width: 100%;\n  height: calc(100% - ${HeaderHorizontalSize}px);\n  display: flex;\n`;\n\nexport default Editor;\n","import React from \"react\";\nimport Editor from \"./Editor\";\nimport { DataProvider } from \"./Store\";\n\nconst ExcelEditor: React.FC = props => (\n  <DataProvider>\n    <Editor />\n  </DataProvider>\n);\n\nexport default ExcelEditor;\n","import { createGlobalStyle } from \"styled-components\";\n\nexport const GlobalStyle = createGlobalStyle`\n    html,\n  body {\n    overflow: hidden;\n  }\n  body {\n    margin: 0;\n    font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", \"Roboto\",\n      \"Oxygen\", \"Ubuntu\", \"Cantarell\", \"Fira Sans\", \"Droid Sans\",\n      \"Helvetica Neue\", sans-serif;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n  }\n  html {\n    font-size: 12px;\n  }\n`;\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport ExcelEditor from \"./ExcelEditor\";\nimport { GlobalStyle } from \"./themes/GlobalStyles\";\n\nconst App: React.FC = () => {\n  return (\n    <>\n      <GlobalStyle />\n      <AppContainer>\n        <ExcelEditor />\n      </AppContainer>\n    </>\n  );\n};\n\nconst AppContainer = styled.div`\n  height: 100vh;\n  width: 100vw;\n`;\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","module.exports = __webpack_public_path__ + \"static/media/plugin-sort-asc.881aaecd.svg\";","module.exports = __webpack_public_path__ + \"static/media/plugin-sort-desc.f0606467.svg\";"],"sourceRoot":""}