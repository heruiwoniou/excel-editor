(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{116:function(e,t,n){e.exports=n.p+"static/media/plugin-function.a701f2ea.svg"},117:function(e,t,n){e.exports=n.p+"static/media/close.1257f21e.svg"},121:function(e,t,n){e.exports=n(261)},261:function(e,t,n){"use strict";n.r(t);var a,o=n(0),r=n.n(o),i=n(11),c=n.n(i),l=n(1),d=n(2);!function(e){e[e.Virtual=0]="Virtual",e[e.Horizontal=1]="Horizontal"}(a||(a={}));var u=n(25),s=function(e){var t=e.type,n=e.size,o=Object(u.a)(e,["type","size"]);return r.a.createElement(p,Object.assign({},o,{style:{width:t===a.Virtual?1:n,height:t===a.Virtual?n:1}}))},p=l.c.div.withConfig({displayName:"PlaceHolder__StyledPlaceHolder",componentId:"sc-17iv86f-0"})([""]),f=function(e){var t=e.rows,n=e.size,a=e.sheetRowIndex,o=e.sheetCellIndex;return r.a.createElement(m,null,new Array(t).fill(null).map(function(e,t){return r.a.createElement(h,{size:n,key:"horizontal-line-".concat(a,"-").concat(o,"-").concat(t)})}))},m=l.c.div.withConfig({displayName:"GridHorizontalLine__GridHorizontalLineContainer",componentId:"ytap67-0"})(["position:absolute;top:0;left:0;right:0;bottom:0;display:flex;flex-direction:column;"]),h=l.c.div.withConfig({displayName:"GridHorizontalLine__HorizontalLineItem",componentId:"ytap67-1"})(["width:100%;height:","px;border-bottom:1px solid #d4d4d4;"],function(e){return e.size}),b=function(e){var t=e.cells,n=e.size,a=e.sheetRowIndex,o=e.sheetCellIndex;return r.a.createElement(g,null,new Array(t).fill(null).map(function(e,t){return r.a.createElement(v,{size:n,key:"virtual-line-".concat(a,"-").concat(o,"-").concat(t)})}))},g=l.c.div.withConfig({displayName:"GridVirtualLine__GridVirtualLineContainer",componentId:"sc-5b0hlp-0"})(["position:absolute;top:0;left:0;right:0;bottom:0;display:flex;flex-direction:row;"]),v=l.c.div.withConfig({displayName:"GridVirtualLine__VirtualLineItem",componentId:"sc-5b0hlp-1"})(["height:100%;width:","px;border-right:1px solid #d4d4d4;"],function(e){return e.size}),y=n(42),C=n.n(y),O=n(8),x=n(3),E=n(16),w=n(48),_=n(116),I=n.n(_),N=function(e){var t=e.isInputMode,n=e.selection,a=Re(),i=Object(d.a)(a,2),c=i[0].settings.plugins,l=i[1],u=Object(o.useCallback)(function(e,t){return function(a){l({type:Ne.PluginAction,payload:{pluginType:e,pluginAction:t,selection:n}})}},[l,n]);return r.a.createElement(j,null,c.map(function(e){var a=Te[e].Component;return r.a.createElement(r.a.Fragment,{key:"fragment-".concat(e)},r.a.createElement(T,{key:"line-".concat(e)}),r.a.createElement(a,{action:u,isInputMode:t,selection:n,key:"button-".concat(e)}))}),r.a.createElement(T,{key:"last-line"}))},j=l.c.div.withConfig({displayName:"Toolbar__ToolbarContainer",componentId:"sc-1t65oco-0"})(["height:","px;display:grid;grid-template-columns:repeat(auto-fill,1px ","px);grid-column-gap:2px;padding:2px;box-sizing:border-box;border-bottom:1px solid #ccc;"],100,100),T=l.c.div.withConfig({displayName:"Toolbar__ToolbarSplitLine",componentId:"sc-1t65oco-1"})(["background:white;height:","px;background:#ccc;"],96),A=l.c.div.withConfig({displayName:"Toolbar__ToolbarCellContainerHeader",componentId:"sc-1t65oco-2"})(["height:20px;text-align:center;border-bottom:1px solid #ccc;"]),k=l.c.div.attrs(function(e){var t=e.disable;return{className:C()(t?"disable":"")}}).withConfig({displayName:"Toolbar__ToolbarCell",componentId:"sc-1t65oco-3"})(["cursor:pointer;text-align:center;display:flex;justify-content:center;align-items:center;flex-direction:column;box-sizing:border-box;border:1px solid transparent;&:hover{background:#efefef;border:1px solid #ccc;}&.disable{opacity:0.5;cursor:not-allowed;&:hover{background:white;border:1px solid transparent;}}"]),L=l.c.div.withConfig({displayName:"Toolbar__ToolbarCellContainer",componentId:"sc-1t65oco-4"})(["display:grid;grid-template-rows:20px auto;grid-row-gap:2px;","{height:auto;flex-direction:row;}"],k),S=l.c.div.withConfig({displayName:"Toolbar__IconsContainer",componentId:"sc-1t65oco-5"})(["overflow:hidden;position:relative;margin:5px;",""],function(e){var t=Object(d.a)(e.size,2),n=t[0],a=t[1];return Object(l.b)(["width:","px;height:","px;"],n,a)}),z=l.c.img.attrs(function(e){return{src:e.src}}).withConfig({displayName:"Toolbar__IconsImage",componentId:"sc-1t65oco-6"})(["position:absolute;width:100%;top:0px;left:0px;"]),R=n(117),F=n.n(R),H=function(e){var t=e.children,n=document.createElement("div");return Object(o.useEffect)(function(){return document.body.appendChild(n),function(){document.body.removeChild(n)}}),c.a.createPortal(t,n)},V=r.a.memo(function(e){var t=e.children,n=e.width,a=void 0===n?800:n,i=e.height,c=void 0===i?600:i,l=e.title,d=e.onClose,u=void 0===d?function(){}:d,s=e.onSure,p=void 0===s?function(){}:s,f=Object(o.useCallback)(function(){u&&u()},[u]),m=Object(o.useCallback)(function(){p&&p()},[p]);return r.a.createElement(H,null,r.a.createElement(M,null,r.a.createElement(U,null,r.a.createElement(D,{width:a,height:c},r.a.createElement(q,null,r.a.createElement(B,null,l),r.a.createElement(P,{onClick:f})),r.a.createElement(G,null,t),r.a.createElement(W,null,r.a.createElement(Y,{onClick:m},"\u786e\u8ba4"),r.a.createElement($,{onClick:f},"\u53d6\u6d88"))))))}),M=l.c.div.withConfig({displayName:"Modal__ModalBackGround",componentId:"uq444t-0"})(["position:fixed;top:0;left:0;height:100vh;width:100vw;background:rgba(0,0,0,0.2);z-index:9999;"]),U=l.c.div.withConfig({displayName:"Modal__ModalPosition",componentId:"uq444t-1"})(["height:80vh;width:100vw;display:flex;justify-content:center;align-items:center;"]),D=l.c.div.withConfig({displayName:"Modal__ModalBox",componentId:"uq444t-2"})([""," background:white;border:1px solid #217346;display:flex;flex-direction:column;box-shadow:0 0 2px #217346;"],function(e){var t=e.width,n=e.height;return Object(l.b)(["width:","px;height:","px;"],t,n)}),P=l.c.img.attrs({src:F.a}).withConfig({displayName:"Modal__CloseButton",componentId:"uq444t-3"})(["height:16px;width:16px;cursor:pointer;"]),B=l.c.div.withConfig({displayName:"Modal__ModalTitle",componentId:"uq444t-4"})(["flex:1;color:white;"]),q=l.c.div.withConfig({displayName:"Modal__ModalHeader",componentId:"uq444t-5"})(["height:30px;padding:7px;box-sizing:border-box;border-bottom:1px solid #217346;background:#217346;display:flex;"]),W=l.c.div.withConfig({displayName:"Modal__ModalFooter",componentId:"uq444t-6"})(["height:40px;background:#c7d6ce;text-align:right;padding:10px;box-sizing:border-box;button{margin-left:10px;}"]),G=l.c.div.withConfig({displayName:"Modal__ModalBody",componentId:"uq444t-7"})(["flex:1;overflow:auto;"]),$=l.c.button.withConfig({displayName:"Modal__ModalCloseButton",componentId:"uq444t-8"})(["height:20px;"]),Y=l.c.button.withConfig({displayName:"Modal__ModalSureButton",componentId:"uq444t-9"})(["height:20px;"]),Z=function(){var e,t=document.createElement("div");return t.style.width="100px",t.style.height="100px",t.style.overflowY="scroll",document.body.appendChild(t),e=t.offsetWidth-t.clientWidth,t.remove(),e}(),J=[].forEach,X=function(e){return(e||"").replace(/^[\s\uFEFF]+|[\s\uFEFF]+$/g,"")};function K(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return J.apply(e,n)}function Q(e,t){if(!e||!t)return!1;if(-1!==t.indexOf(" "))throw new Error("className should not contain space.");return e.classList?e.classList.contains(t):(" "+e.className+" ").indexOf(" "+t+" ")>-1}function ee(e,t){if(e){for(var n=e.className,a=(t||"").split(" "),o=0,r=a.length;o<r;o++){var i=a[o];i&&(e.classList?e.classList.add(i):Q(e,i)||(n+=" "+i))}e.classList||(e.className=n)}}function te(e,t){if(e&&t){for(var n=t.split(" "),a=" "+e.className+" ",o=0,r=n.length;o<r;o++){var i=n[o];i&&(e.classList?e.classList.remove(i):Q(e,i)&&(a=a.replace(" "+i+" "," ")))}e.classList||(e.className=X(a))}}var ne="A".charCodeAt(0);function ae(e){for(var t=0,n=e.length,a=0;a<n;a++)t+=(e.charCodeAt(0)-ne+1)*Math.pow(26,n-a-1);return t}function oe(e){var t="";e--;do{t.length>0&&e--,t=String.fromCharCode(e%26+ne)+t,e=(e-e%26)/26}while(e>0);return t}var re,ie,ce={type:"sum",begin:"",end:""},le=[-1,-1,-1,-1],de={functionstate:{openDialog:!1,initialValues:ce,selection:le}},ue={FUNCTION_DEFAULT_ACTION:"FUNCTION_DEFAULT_ACTION",FUNCTION_CLOSE_MODAL_ACTION:"FUNCTION_CLOSE_MODAL_ACTION",FUNCTION_SAVE_ACTION:"FUNCTION_SAVE_ACTION"},se=/^([A-Z]+)([1-9]+[0-9]*)$/,pe=function(e){var t;switch(e.type){case"sum":t=e.params.map(function(e){return e.map(function(e){var t=e.match(se);return t?[ae(t[1]),~~t[2]]:null})})}return{type:e.type,params:t,original:e.original}},fe=w.object().shape({begin:w.string().matches(/^[A-Z]+[1-9]+[0-9]*$/,"\u683c\u5f0f\u9519\u8bef (A1,B2, AA1, ...)").required("\u5fc5\u586b\u9879"),end:w.string().matches(/^[A-Z]+[1-9]+[0-9]*$/,"\u683c\u5f0f\u9519\u8bef (A1,B2, AA1, ...)").required("\u5fc5\u586b\u9879")}),me=l.c.div.withConfig({displayName:"Function__ModalContent",componentId:"sc-1lczrjs-0"})(["padding:1px 20px;overflow-y:auto;"]),he=l.c.span.withConfig({displayName:"Function__ErrorContainer",componentId:"sc-1lczrjs-1"})(["color:red;margin-left:10px;"]),be={Component:function(e){var t=function(e){var t=e.isInputMode,n=e.selection;return t||-1===n[0]}(e),n=Object(o.useRef)(null),a=Re(),i=Object(d.a)(a,2),c=i[0],l=i[1],u=c.functionstate.openDialog,s=Object(o.useCallback)(function(){l({type:Ne.PluginAction,payload:{pluginType:ie.FUNCTION,pluginAction:ue.FUNCTION_CLOSE_MODAL_ACTION}})},[l]),p=Object(o.useCallback)(function(){n.current&&n.current.submitForm()},[]),f=Object(o.useCallback)(function(e){l({type:Ne.PluginAction,payload:{pluginType:ie.FUNCTION,pluginAction:ue.FUNCTION_SAVE_ACTION,value:{type:e.type,params:[[e.begin,e.end]],original:e}}})},[l]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(k,{disable:t,onClick:e.action(ie.FUNCTION,ue.FUNCTION_DEFAULT_ACTION)},r.a.createElement(S,{size:[32,32]},r.a.createElement(z,{src:I.a})),"\u63d2\u5165\u51fd\u6570"),u&&r.a.createElement(V,{title:"\u51fd\u6570",height:300,width:600,onClose:s,onSure:p},r.a.createElement(me,null,r.a.createElement(E.c,{ref:n,initialValues:c.functionstate.initialValues,onSubmit:f,validationSchema:fe},function(e){return r.a.createElement("form",{onSubmit:e.handleSubmit},r.a.createElement("h3",null,"\u9009\u62e9\u51fd\u6570:"),r.a.createElement(E.b,{component:"select",name:"type"},r.a.createElement("option",{value:"sum"},"SUM")),r.a.createElement("div",null,r.a.createElement("h4",null,"\u5f00\u59cb:"),r.a.createElement(E.b,{type:"text",name:"begin",placeholder:"A1"}),r.a.createElement(he,null,r.a.createElement(E.a,{name:"begin"}))),r.a.createElement("div",null,r.a.createElement("h4",null,"\u7ed3\u675f:"),r.a.createElement(E.b,{type:"text",name:"end",placeholder:"B5"}),r.a.createElement(he,null,r.a.createElement(E.a,{name:"end"}))))}))))},reducer:function(e,t){var n=t.payload;switch(n.pluginAction){case ue.FUNCTION_DEFAULT_ACTION:var a=n.initialValues||ce;return Object(x.a)({},e,{settings:Object(x.a)({},e.settings,{disablekeyboardMonitoring:!0}),functionstate:{openDialog:!0,initialValues:a,selection:n.selection}});case ue.FUNCTION_CLOSE_MODAL_ACTION:return Object(x.a)({},e,{settings:Object(x.a)({},e.settings,{disablekeyboardMonitoring:!1}),functionstate:{openDialog:!1,initialValues:ce,selection:le}});case ue.FUNCTION_SAVE_ACTION:var o=n.value,r=e.functionstate.selection,i=Object(d.a)(r,2),c=i[0],l=i[1],u=Object(O.a)({},"".concat(l+1,":").concat(c+1),{type:je.Function,value:pe(o)});return Object(x.a)({},e,{settings:Object(x.a)({},e.settings,{disablekeyboardMonitoring:!1}),functionstate:{openDialog:!1,initialValues:ce,selection:le},data:Object(x.a)({},e.data,u)})}return e},state:de,actions:ue},ge=n(24),ve=n.n(ge),ye=n(45),Ce=n.n(ye),Oe=n(46),xe=n.n(Oe),Ee={COL_SORT_DEFAULT_ACTION:"COL_SORT_DEFAULT_ACTION",COL_SORT_DEFAULT_ACTION_DESC:"COL_SORT_DEFAULT_ACTION_DESC"},we={Component:function(e){var t=function(e){var t=e.isInputMode,n=e.selection;return t||-1===n[0]}(e);return r.a.createElement(L,null,r.a.createElement(A,null,"\u5217"),r.a.createElement(k,{disable:t,onClick:e.action(ie.COL_SORT,Ee.COL_SORT_DEFAULT_ACTION)},r.a.createElement(S,{size:[16,16]},r.a.createElement(z,{src:Ce.a})),"\u5347\u5e8f\u6392\u5e8f"),r.a.createElement(k,{disable:t,onClick:e.action(ie.COL_SORT,Ee.COL_SORT_DEFAULT_ACTION_DESC)},r.a.createElement(S,{size:[16,16]},r.a.createElement(z,{src:xe.a})),"\u964d\u5e8f\u6392\u5e8f"))},state:{},reducer:function(e,t){for(var n=t.payload,a=n.pluginAction,o=Object(d.a)(n.selection,4),r=o[0],i=o[1],c=o[2],l=o[3],u=Object(x.a)({},e.data),s=[],p=i+1,f=l+1,m=r+1,h=c+1,b=p;b<=f;b++){for(var g=[],v=m;v<=h;v++){var y=u["".concat(b,":").concat(v)];y&&g.push(y)}g=ve.a.sortBy(g,["value"]),a===Ee.COL_SORT_DEFAULT_ACTION_DESC&&g.reverse(),s.push(g)}for(var C=p;C<=f;C++)for(var O=m;O<=h;O++){var E=s[C-p][O-m];E?u["".concat(C,":").concat(O)]=E:delete u["".concat(C,":").concat(O)]}return Object(x.a)({},e,{data:u})},actions:Ee},_e={ROW_SORT_DEFAULT_ACTION:"ROW_SORT_DEFAULT_ACTION",ROW_SORT_DEFAULT_ACTION_DESC:"ROW_SORT_DEFAULT_ACTION_DESC"},Ie={Component:function(e){var t=function(e){var t=e.isInputMode,n=e.selection;return t||-1===n[0]}(e);return r.a.createElement(L,null,r.a.createElement(A,null,"\u884c"),r.a.createElement(k,{disable:t,onClick:e.action(ie.ROW_SORT,_e.ROW_SORT_DEFAULT_ACTION)},r.a.createElement(S,{size:[16,16]},r.a.createElement(z,{src:Ce.a})),"\u5347\u5e8f\u6392\u5e8f"),r.a.createElement(k,{disable:t,onClick:e.action(ie.ROW_SORT,_e.ROW_SORT_DEFAULT_ACTION_DESC)},r.a.createElement(S,{size:[16,16]},r.a.createElement(z,{src:xe.a})),"\u964d\u5e8f\u6392\u5e8f"))},state:{},reducer:function(e,t){for(var n=t.payload,a=n.pluginAction,o=Object(d.a)(n.selection,4),r=o[0],i=o[1],c=o[2],l=o[3],u=Object(x.a)({},e.data),s=[],p=i+1,f=l+1,m=r+1,h=c+1,b=m;b<=h;b++){for(var g=[],v=p;v<=f;v++){var y=u["".concat(v,":").concat(b)];y&&g.push(y)}g=ve.a.sortBy(g,["value"]),a===_e.ROW_SORT_DEFAULT_ACTION_DESC&&g.reverse(),s.push(g)}for(var C=m;C<=h;C++)for(var O=p;O<=f;O++){var E=s[C-m][O-p];E?u["".concat(O,":").concat(C)]=E:delete u["".concat(O,":").concat(C)]}return Object(x.a)({},e,{data:u})},actions:_e};!function(e){e.FUNCTION="function",e.COL_SORT="colsort",e.ROW_SORT="rowsort"}(ie||(ie={}));var Ne,je,Te=(re={},Object(O.a)(re,ie.FUNCTION,be),Object(O.a)(re,ie.COL_SORT,we),Object(O.a)(re,ie.ROW_SORT,Ie),re);!function(e){e.Update="update",e.Delete="delete",e.PluginAction="pluginAction"}(Ne||(Ne={})),function(e){e[e.Number=0]="Number",e[e.String=1]="String",e[e.Function=2]="Function"}(je||(je={}));var Ae={};Object.keys(Te).forEach(function(e){Ae=Object(x.a)({},Ae,Te[e].state)});var ke=Object(x.a)({data:{},settings:{disablekeyboardMonitoring:!1,plugins:[ie.FUNCTION,ie.COL_SORT,ie.ROW_SORT]}},Ae),Le=function(e,t){var n;switch(t.type){case Ne.Update:var a=t.payload.key,o=t.payload.value;return Object(x.a)({},e,{data:Object(x.a)({},e.data,Object(O.a)({},a,o))});case Ne.Delete:return n=Object(x.a)({},e,{data:Object(x.a)({},e.data)}),t.payload.keys.forEach(function(e){n.data[e]&&delete n.data[e]}),n;case Ne.PluginAction:return Te[t.payload.pluginType].reducer(e,t);default:throw new Error}},Se=r.a.createContext([ke,function(){}]),ze=function(e){var t=e.children,n=Object(o.useReducer)(Le,ke);return r.a.createElement(Se.Provider,{value:n},t)},Re=function(){return Object(o.useContext)(Se)},Fe=function(e){var t=e.pageRowIndex,n=e.pageCellIndex,a=Re(),i=Object(d.a)(a,1)[0],c=i.data,l=Object(o.useCallback)(function(e){var t=e.type,n=e.params;try{switch(t){case"sum":for(var a=0,o=0;o<n.length;o++){var r=Object(d.a)(n[o],2),i=r[0],l=r[1];if(null===i||null===l)return"Error";var u=Object(d.a)(i,2),s=u[0],p=u[1],f=Object(d.a)(l,2),m=f[0],h=f[1];s>m&&(s^=m,s^=m^=s),p>h&&(p^=h,p^=h^=p);for(var b=p;b<=h;b++)for(var g=s;g<=m;g++){var v=c["".concat(g,":").concat(b)];v&&v.type===je.Number&&(a+=Number(v.value))}}return a;default:return"Error"}}catch(y){return"Error"}},[c]);return r.a.createElement(He,null,new Array(50).fill(null).map(function(e,a){var o=50*t+a+1;return r.a.createElement(Ve,{key:"grid-value-row-".concat(o)},new Array(20).fill(null).map(function(e,t){var a=20*n+t+1,c=i.data["".concat(a,":").concat(o)];return c&&r.a.createElement(Me,{className:C()(c.type===je.Function?"function-data":""),key:"".concat(a,":").concat(o),id:"value-cell-".concat(a,"-").concat(o),style:{left:"".concat(80*t,"px")}},c.type===je.Function?l(c.value):c.value)}))}))},He=l.c.div.withConfig({displayName:"GridValues__GridValuesContainer",componentId:"sc-1eflswa-0"})(["height:100%;width:100%;"]),Ve=l.c.div.withConfig({displayName:"GridValues__GridRow",componentId:"sc-1eflswa-1"})(["position:relative;height:","px;"],20),Me=l.c.div.withConfig({displayName:"GridValues__GridCell",componentId:"sc-1eflswa-2"})(["position:absolute;top:0;width:","px;height:","px;line-height:","px;padding:0 2px 0 1px;box-sizing:border-box;font-size:12px;overflow:hidden;&.function-data{background:#c7d6ce;}"],79,20,20),Ue=function(e){var t=e.pageVerticalIndex,n=e.pageHorizontalIndex;return r.a.createElement(De,null,r.a.createElement(f,{sheetRowIndex:t,sheetCellIndex:n,rows:50,size:20}),r.a.createElement(b,{sheetRowIndex:t,sheetCellIndex:n,cells:20,size:80}),r.a.createElement(Fe,{pageRowIndex:t,pageCellIndex:n}))},De=l.c.div.withConfig({displayName:"VirtualPagerCell__StyledVirtualPagerCell",componentId:"fj38ao-0"})(["float:left;height:","px;width:","px;position:relative;"],1e3,1600),Pe=function(e){var t=e.pageVerticalIndex,n=e.pageHorizontalIndex,o=e.perLoadHorizontalCount,i=e.rearLoadHorizontalCount,c=Object(u.a)(e,["pageVerticalIndex","pageHorizontalIndex","perLoadHorizontalCount","rearLoadHorizontalCount"]);return r.a.createElement(Be,c,r.a.createElement(s,{type:a.Horizontal,size:n-o>0?1600*(n-o):0}),r.a.createElement("div",null,new Array(o).fill(null).map(function(e,a){var i=o-a;return n-i>=0&&r.a.createElement(Ue,{key:"perload-".concat(n-i),pageVerticalIndex:t,pageHorizontalIndex:n-i})}),r.a.createElement(Ue,{key:"current-".concat(n),pageVerticalIndex:t,pageHorizontalIndex:n}),new Array(i).fill(null).map(function(e,a){var o=a+1;return r.a.createElement(Ue,{key:"rearload-".concat(n+o),pageVerticalIndex:t,pageHorizontalIndex:n+o})})))},Be=l.c.div.withConfig({displayName:"VirtualPagerRow__StyledVirtualPagerRow",componentId:"sc-1cb6dck-0"})(["height:","px;width:100%;display:flex;"],1e3),qe=function(e){var t=e.value,n=Object(u.a)(e,["value"]);return r.a.createElement(We,n,t)},We=l.c.div.withConfig({displayName:"HeaderCell__StyledHeaderCell",componentId:"caezde-0"})(["position:relative;font-size:12px;text-align:center;height:","px;line-height:",'px;&:before{content:"";position:absolute;background:#dfdfdf;}&:after{position:absolute;background:#217346;}&.selection{color:#217346;font-weight:bold;background:#dad8d6;&:before{background:#bfbfbf;}&:after{content:"";}}',""],function(e){return e.type,a.Virtual,20},function(e){return e.type,a.Virtual,20},function(e){return e.type===a.Virtual?Object(l.b)(["&:before{left:0;bottom:0;width:100%;height:1px;}&.selection:after{right:-1px;top:-2px;bottom:-1px;width:2px;}"]):Object(l.b)(["width:","px;&:before{top:0;right:0;height:100%;width:1px;}&.selection:after{bottom:0px;;left:-2px;right:-1px;height:2px;}"],80)}),Ge=function(e){var t=e.headerRef,n=e.pageHorizontalIndex,o=e.perLoadHorizontalCount,i=e.rearLoadHorizontalCount;return r.a.createElement(Ye,null,r.a.createElement(Ze,{className:"header-corner"}),r.a.createElement(Je,{ref:t},r.a.createElement("div",{style:{width:1600*(n+i+1)}},r.a.createElement($e,{type:a.Horizontal,size:n-o>0?1600*(n-o):0}),r.a.createElement(Xe,null,new Array(o).fill(null).map(function(e,t){var i=o-t,c=n-i;return n-i>=0&&r.a.createElement(Ke,{key:"perload-".concat(c),"data-key":"perload-".concat(c)},new Array(20).fill(null).map(function(e,t){var n=20*c+t+1;return r.a.createElement(qe,{key:"horizontal-header-cell-".concat(n),className:"horizontal-header-cell-".concat(n),type:a.Horizontal,value:oe(n)})}))}),r.a.createElement(Ke,{key:"current-".concat(n),"data-key":"current-".concat(n)},new Array(20).fill(null).map(function(e,t){var o=20*n+t+1;return r.a.createElement(qe,{key:"horizontal-header-cell-".concat(o),className:"horizontal-header-cell-".concat(o),type:a.Horizontal,value:oe(o)})})),new Array(i).fill(null).map(function(e,t){var o=n+(t+1);return r.a.createElement(Ke,{key:"rearload-".concat(o),"data-key":"rearload-".concat(o)},new Array(20).fill(null).map(function(e,t){var n=20*o+t+1;return r.a.createElement(qe,{key:"horizontal-header-cell-".concat(n),className:"horizontal-header-cell-".concat(n),type:a.Horizontal,value:oe(n)})}))})))))},$e=Object(l.c)(s).withConfig({displayName:"HeaderHorizontal__StyledPlaceHolder",componentId:"sc-1tp3d5n-0"})(["float:left;height:","px;"],20),Ye=l.c.div.withConfig({displayName:"HeaderHorizontal__HeaderHorizontalContainer",componentId:"sc-1tp3d5n-1"})(["width:100%;background:#edebe9;position:relative;"]),Ze=l.c.div.withConfig({displayName:"HeaderHorizontal__HeaderCorner",componentId:"sc-1tp3d5n-2"})(["position:absolute;top:0;left:0;box-sizing:border-box;width:","px;height:",'px;border-bottom:1px solid #dfdfdf;border-right:1px solid #dfdfdf;&.selection:after{content:"";position:absolute;right:-1px;bottom:-1px;height:2px;width:2px;background:#217346;}'],40,20),Je=l.c.div.withConfig({displayName:"HeaderHorizontal__HeaderContainer",componentId:"sc-1tp3d5n-3"})(["width:calc(100% - ","px);margin-left:","px;overflow:hidden;"],40+Z,40),Xe=l.c.div.withConfig({displayName:"HeaderHorizontal__CellsContainer",componentId:"sc-1tp3d5n-4"})(["overflow:hidden;float:left;"]),Ke=l.c.div.withConfig({displayName:"HeaderHorizontal__HeaderPager",componentId:"sc-1tp3d5n-5"})(["height:","px;width:","px;float:left;display:flex;"],20,1600),Qe=function(e){var t=e.headerRef,n=e.pageVerticalIndex,o=e.perLoadVerticalCount,i=e.rearLoadVerticalCount;return r.a.createElement(et,null,r.a.createElement(tt,{ref:t},r.a.createElement(s,{type:a.Virtual,size:n-o>0?1e3*(n-o):0}),r.a.createElement("div",null,new Array(o).fill(null).map(function(e,t){var i=n-(o-t);return i>=0&&r.a.createElement(nt,{key:"perload-".concat(i),"data-key":"perload-".concat(i)},new Array(50).fill(null).map(function(e,t){var o=50*n+t+1;return r.a.createElement(qe,{key:"vertical-header-cell-".concat(o),className:"vertical-header-cell-".concat(o),type:a.Virtual,value:"".concat(o)})}))}),r.a.createElement(nt,{key:"current-".concat(n),"data-key":"current-".concat(n)},new Array(50).fill(null).map(function(e,t){var o=50*n+t+1;return r.a.createElement(qe,{key:"vertical-header-cell-".concat(o),className:"vertical-header-cell-".concat(o),type:a.Virtual,value:"".concat(o)})})),new Array(i).fill(null).map(function(e,t){var o=n+(t+1);return r.a.createElement(nt,{key:"rearload-".concat(o),"data-key":"rearload-".concat(o)},new Array(50).fill(null).map(function(e,t){var n=50*o+t+1;return r.a.createElement(qe,{key:"vertical-header-cell-".concat(n),className:"vertical-header-cell-".concat(n),type:a.Virtual,value:"".concat(n)})}))}))))},et=l.c.div.withConfig({displayName:"HeaderVertical__HeaderVerticalContainer",componentId:"cfh0zo-0"})(["background:#edebe9;"]),tt=l.c.div.withConfig({displayName:"HeaderVertical__HeaderContainer",componentId:"cfh0zo-1"})(["width:","px;height:calc(100% - ","px);overflow:hidden;"],40,Z-1),nt=l.c.div.withConfig({displayName:"HeaderVertical__HeaderPager",componentId:"cfh0zo-2"})(["height:","px;width:","px;border-right:solid 1px #bbb;box-sizing:border-box;"],1e3,40),at=function(e){var t=e.selectionRef,n=e.isInputMode,a=e.exitInputMode,i=e.startRowIndex,c=e.startCellIndex,l=Object(o.useRef)(null),u=Re(),s=Object(d.a)(u,1)[0].data["".concat(c+1,":").concat(i+1)],p=(s=void 0===s?{value:""}:s).value,f=void 0===p?"":p,m=Object(o.useCallback)(function(e){var t=l.current;t&&a(X(t.value),i+1,c+1)},[n]);return Object(o.useEffect)(function(){n&&l.current&&(l.current.focus(),l.current.select())},[n]),r.a.createElement(r.a.Fragment,null,r.a.createElement(st,{ref:t,style:{left:-9999}},r.a.createElement(ot,null,r.a.createElement(rt,null)),r.a.createElement(ct,null,n&&r.a.createElement(lt,{className:"edit-mode-input",ref:l,defaultValue:f,onBlur:m})),r.a.createElement(dt,null),r.a.createElement(ut,null)))},ot=l.c.div.withConfig({displayName:"Selection__SelectionBorder",componentId:"sc-4it71b-0"})(["position:absolute;top:-2px;left:-2px;right:-1px;bottom:-1px;border:2px solid #217346;"]),rt=l.c.div.withConfig({displayName:"Selection__SelectionInnerBorder",componentId:"sc-4it71b-1"})(["border:1px solid #fff;position:absolute;top:0;bottom:0;left:0;right:0;z-index:1;"]),it=Object(l.b)(["position:absolute;right:0;background:#141414;opacity:0.24;"]),ct=l.c.div.withConfig({displayName:"Selection__SelectionInputArea",componentId:"sc-4it71b-2"})(["height:","px;width:","px;position:absolute;left:0;top:0;"],19,80),lt=l.c.input.attrs(function(e){return{type:"text"}}).withConfig({displayName:"Selection__StyledInput",componentId:"sc-4it71b-3"})(["border:0px;background:#eee;height:100%;width:calc(100% - 1px);margin:0;line-height:","px;padding:0 1px;outline:none;box-sizing:border-box;vertical-align:top;font-size:12px;"],19),dt=l.c.div.withConfig({displayName:"Selection__SelectionAreaTop",componentId:"sc-4it71b-4"})([""," top:0;left:","px;height:","px;"],it,79,19),ut=l.c.div.withConfig({displayName:"Selection__SelectionAreaBottom",componentId:"sc-4it71b-5"})([""," top:","px;left:0;bottom:0;"],it,19),st=l.c.div.withConfig({displayName:"Selection__SelectionContainer",componentId:"sc-4it71b-6"})(["position:absolute;"]),pt=function(e,t,n,a,r,i,c,l,d){Object(o.useEffect)(function(){var o=e.current,u=t.current,s=n.current;o&&(o.scrollTop=a,o.scrollLeft=r),u&&(u.scrollTop=a,u.scrollLeft=r),s&&(s.scrollTop=a,s.scrollLeft=r);var p=function(e){var a,o,r,u,s;e.target&&(o=(a=e.target).scrollTop,u=a.scrollLeft,t.current&&(t.current.scrollTop=o),(s=Math.floor(o/1e3))!==c&&d(s,u,o),n.current&&(n.current.scrollLeft=u),(r=Math.floor(u/1600))!==i&&l(r,u,o))};return o&&o.addEventListener("scroll",p),function(){o&&o.removeEventListener("scroll",p)}},[e,n,t,a,r,i,c,l,d])},ft=function(e,t,n,a){Object(o.useEffect)(function(){var a,o,r,i,c,l,d,u=e.current,s=t.current,p=function(){return!!document.querySelector(".edit-mode-input")},f=function(){var e=function(e){var t=e.startRowIndex,n=e.endRowIndex,a=e.startCellIndex,o=e.endCellIndex;return{display:-1===t?"none":"block",top:20*t,left:80*a,width:80*(Math.abs(o-a)+1),height:20*(Math.abs(n-t)+1)}}({startRowIndex:l?r:a,endRowIndex:l?a:r,startCellIndex:c?i:o,endCellIndex:c?o:i}),t=e.top,n=e.left,d=e.width,u=e.height;s&&(s.style.top="".concat(t,"px"),s.style.left="".concat(n,"px"),s.style.width="".concat(d,"px"),s.style.height="".concat(u,"px")),K(document.querySelectorAll(".selection"),function(e){return te(e,"selection")});var p=document.querySelector(".header-corner");0===o||0===i?ee(p,"selection"):te(p,"selection"),K(document.querySelectorAll(new Array(Math.abs(i-o)).fill(null).reduce(function(e,t,n){return e+", .horizontal-header-cell-".concat((c?i:o)+n+2)},".horizontal-header-cell-".concat((c?i:o)+1))),function(e){return ee(e,"selection")}),K(document.querySelectorAll(new Array(Math.abs(r-a)).fill(null).reduce(function(e,t,n){return e+", .vertical-header-cell-".concat((l?r:a)+n+2)},".vertical-header-cell-".concat((l?r:a)+1))),function(e){return ee(e,"selection")})},m=function(e){c=!1,l=!1;var t=u?u.scrollTop:0,s=u?u.scrollLeft:0;d=document.onselectstart,document.onselectstart=function(){return!1},o=i=Math.floor((s+e.clientX-40)/80),a=r=Math.floor((t+e.clientY-20-100)/20),n([a,o,r,i]),f(),document.removeEventListener("mouseup",h),document.removeEventListener("mousemove",b),document.addEventListener("mousemove",b),document.addEventListener("mouseup",h)},h=function e(t){p()||(document.onselectstart=d,document.removeEventListener("mouseup",e),document.removeEventListener("mousemove",b),n([l?r:a,c?i:o,l?a:r,c?o:i]))},b=function(e){if(!p()){var t=u?u.scrollTop:0,n=u?u.scrollLeft:0;i=Math.floor((n+e.clientX-40)/80),r=Math.floor((t+e.clientY-20-100)/20),c=(i=i<0?0:i)<o,l=(r=r<0?0:r)<a,f()}};return u&&u.addEventListener("mousedown",m),function(){u&&u.removeEventListener("mousedown",m)}},[e,t,n]),Object(o.useEffect)(function(){var e=function(e){var t=e.keyCode,n=e.target;[8,46].includes(t)&&"INPUT"!==n.nodeName&&a()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}},[a])},mt=function(e,t){var n=Re(),a=Object(d.a)(n,1)[0].settings.disablekeyboardMonitoring;Object(o.useEffect)(function(){var n=e.current,a=function(e){return t()};return n&&n.addEventListener("dblclick",a),function(){n&&n.removeEventListener("dblclick",a)}},[e,t]),Object(o.useEffect)(function(){var e=function(e){var n=e.keyCode;!a&&(n>=48&&n<=57||n>=96&&n<=111||n>=65&&n<=90||n>=186&&n<=192||n>=186&&n<=222)&&t()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}},[t,a])},ht=function(e,t,n){Object(o.useEffect)(function(){var a=Object(ge.throttle)(function(){var a=e.current;if(a){var o=a.offsetWidth;n(o<1600?1:Math.floor(o/1600));var r=a.offsetHeight;r<1e3&&t(Math.ceil(r/1e3))}});return a(),window.addEventListener("resize",a),function(){window.removeEventListener("resize",a)}},[e,t,n])},bt=l.c.div.withConfig({displayName:"Editor__TableContainer",componentId:"ulljbi-0"})(["height:calc(100vh - ","px);width:100vw;"],100),gt=l.c.div.withConfig({displayName:"Editor__VirtualContainer",componentId:"ulljbi-1"})(["height:100%;width:100%;overflow:scroll;position:relative;"]),vt=l.c.div.withConfig({displayName:"Editor__ContentContainer",componentId:"ulljbi-2"})(["width:100%;height:calc(100% - ","px);display:flex;"],20),yt=function(){var e=Re(),t=Object(d.a)(e,2),n=t[0],i=t[1],l=Object(o.useState)([-1,-1,-1,-1]),u=Object(d.a)(l,2),p=u[0],f=u[1],m=Object(o.useState)(!1),h=Object(d.a)(m,2),b=h[0],g=h[1],v=Object(o.useRef)(null),y=Object(o.useState)(0),C=Object(d.a)(y,2),O=C[0],x=C[1],E=Object(o.useState)(0),w=Object(d.a)(E,2),_=w[0],I=w[1],j=Object(o.useState)(1),T=Object(d.a)(j,2),A=T[0],k=T[1],L=Object(o.useState)(1*A),S=Object(d.a)(L,2),z=S[0],R=S[1],F=Object(o.useState)(2*A),H=Object(d.a)(F,2),V=H[0],M=H[1],U=Object(o.useCallback)(function(e,t,n){return c.a.unstable_batchedUpdates(function(){G(t),x(n),I(e)})},[]),D=Object(o.useCallback)(function(e){k(e),R(1*e),M(2*e)},[]),P=Object(o.useRef)(null),B=Object(o.useState)(0),q=Object(d.a)(B,2),W=q[0],G=q[1],$=Object(o.useState)(0),Y=Object(d.a)($,2),Z=Y[0],J=Y[1],X=Object(o.useState)(1),K=Object(d.a)(X,2),Q=K[0],ee=K[1],te=Object(o.useState)(1*Q),ne=Object(d.a)(te,2),ae=ne[0],oe=ne[1],re=Object(o.useState)(2*Q),ce=Object(d.a)(re,2),le=ce[0],de=ce[1],ue=Object(o.useCallback)(function(e,t,n){return c.a.unstable_batchedUpdates(function(){G(t),x(n),J(e)})},[]),se=Object(o.useCallback)(function(e){return c.a.unstable_batchedUpdates(function(){ee(e),oe(1*e),de(2*e)})},[]),pe=Object(o.useRef)(null),fe=Object(o.useRef)(null),me={pageHorizontalIndex:Z,perLoadHorizontalCount:ae,rearLoadHorizontalCount:le},he=Object(d.a)(p,4),be=he[0],ge=he[1],ve=he[2],ye=he[3],Ce={headerRef:v,pageVerticalIndex:_,perLoadVerticalCount:z,rearLoadVerticalCount:V,selectionStart:be,selectionEnd:ve},Oe={headerRef:P,pageHorizontalIndex:Z,perLoadHorizontalCount:ae,rearLoadHorizontalCount:le,selectionStart:ge,selectionEnd:ye},xe=Object(o.useCallback)(function(e,t,n){if(g(!1),e){var a=!isNaN(Number(e));i({type:Ne.Update,payload:{key:"".concat(n,":").concat(t),value:{type:a?je.Number:je.String,value:a?Number(e):e}}})}else i({type:Ne.Delete,payload:{keys:["".concat(n,":").concat(t)]}})},[i]),Ee=Object(o.useCallback)(function(){var e=ge+1,t=be+1,a=n.data["".concat(e,":").concat(t)];a&&a.type===je.Function?i({type:Ne.PluginAction,payload:{pluginType:ie.FUNCTION,pluginAction:Te[ie.FUNCTION].actions.FUNCTION_DEFAULT_ACTION,selection:[be,ge,ve,ye],initialValues:a.value.original}}):g(!0)},[g,i,n.data,be,ge,ve,ye]),we=Object(o.useCallback)(function(){for(var e=[],t=be;t<=ve;t++)for(var n=ge;n<=ye;n++)e.push("".concat(n+1,":").concat(t+1));e.length&&i({type:Ne.Delete,payload:{keys:e}})},[be,ve,ge,ye,i]);pt(pe,v,P,O,W,Z,_,ue,U),ft(pe,fe,f,we),mt(pe,Ee),ht(pe,se,D);for(var _e=arguments.length,Ie=new Array(_e),Ae=0;Ae<_e;Ae++)Ie[Ae]=arguments[Ae];return r.a.createElement(r.a.Fragment,null,r.a.createElement(N,{isInputMode:b,selection:p}),r.a.createElement(bt,null,r.a.createElement(Ge,Oe),r.a.createElement(vt,null,r.a.createElement(Qe,Ce),r.a.createElement(gt,Object.assign({ref:pe},Ie),r.a.createElement(s,{type:a.Virtual,size:_-z>0?1e3*(_-z):0}),r.a.createElement("div",{style:{width:1600*(Z+le+1)}},new Array(z).fill(null).map(function(e,t){var n=z-t;return _-n>=0&&r.a.createElement(Pe,Object.assign({key:"perload-".concat(_-n),"data-key":"perload-".concat(_-n),pageVerticalIndex:_-n},me))}),r.a.createElement(Pe,Object.assign({key:"current-".concat(_),"data-key":"current-".concat(_),pageVerticalIndex:_},me)),new Array(V).fill(null).map(function(e,t){var n=t+1;return r.a.createElement(Pe,Object.assign({key:"rearload-".concat(_+n),"data-key":"rearload-".concat(_+n),pageVerticalIndex:_+n},me))})),r.a.createElement(at,{selectionRef:fe,exitInputMode:xe,isInputMode:b,startRowIndex:be,endRowIndex:ve,startCellIndex:ge,endCellIndex:ye})))))},Ct=function(e){return r.a.createElement(ze,null,r.a.createElement(yt,null))},Ot=n(118);function xt(){var e=Object(Ot.a)(['\n    html,\n  body {\n    overflow: hidden;\n  }\n  body {\n    margin: 0;\n    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto",\n      "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans",\n      "Helvetica Neue", sans-serif;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n  }\n  html {\n    font-size: 12px;\n  }\n']);return xt=function(){return e},e}var Et=Object(l.a)(xt()),wt=l.c.div.withConfig({displayName:"App__AppContainer",componentId:"sc-15jdvi9-0"})(["height:100vh;width:100vw;"]),_t=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Et,null),r.a.createElement(wt,null,r.a.createElement(Ct,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(_t,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},45:function(e,t,n){e.exports=n.p+"static/media/plugin-sort-asc.881aaecd.svg"},46:function(e,t,n){e.exports=n.p+"static/media/plugin-sort-desc.f0606467.svg"}},[[121,1,2]]]);
//# sourceMappingURL=main.ddc9dac9.chunk.js.map